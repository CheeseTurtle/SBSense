[analyzeHCsP] (1) Internal (9 args)
[analyzeHCsP] (1) timePos:    31-Aug-2023 11:32:18
[analyzeHCsP] (1) Y0s class & size: uint16,         2038        3264
[analyzeHCsP] 1) Y1 class & size before crop: uint16,         2448        3264
[analyzeHCsP] (1) Num. IP points: 1631; Y1s class & size: uint16,         2038        3264
[analyzeCompositeP] (1) Size of Y0s: 2038       3264
[analyzeCompositeP] (1) Size of Y1s: 2038       3264
[analyzeCompositeP] (1) numChannels: 3
[analyzeCompositeP]::117 Class of Y0s,Y1s,Y0,Y1,Yr, ELI: int16,uint16,uint16,uint16,single, single
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (1) DIARY OF FUTURE 5 (chNum 1):
[analyzeCompositeChannel]::1/1 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::1/1 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 7 peaks (strictness: 2), of which 6 meet(s) the general height and location requirements:
    Loc      Hgt       Wid        Prm        Score     Mask 
    ___    _______    ______    ________    _______    _____
    107    0.38135        75    0.092006    0.62523    true 
    157    0.33942        45    0.029851    0.30106    true 
    193    0.33919    83.185    0.033885    0.31721    true 
     44    0.33507        29    0.024879    0.27349    true 
    324    0.24354        65    0.082168    0.35704    true 
    356    0.24043    28.947    0.026646    0.12426    true 
    443    0.16966    27.533     0.18341       0.65    false
[sbestimatepeakloc] > p0g: [107 37.5 14.3006] (hgt: 0.381351, HW: 37.5, L/R: [69 145])
[sbestimatepeakloc] > Max val in peak body: 0.421318
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.343216 -0.253609], HW range: [1.275 41.25], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.4376 ; 3264 41.25 -10.4614]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.4376 ; 3264 41.25 -10.4614]
[curvefit] NumSampPoints: 77; class of XDATA: double, size of XDATA: [1 77]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 0.9316
Size of XDATA: [1 77]
Size of YDATA: [1 77]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.931605, [107 37.5 14.3006]
[sbestimatepeakloc] < p1WF: [111.051 46.1467 20.7083]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 14.3006/37.5 = 0.381351 > maxPkHgt -0.253609.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=14179.5, cfitBounds=[1 3264], p1=[111.051 46.1467 20.7083]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 14179.5 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [107 37.5 14.3006] (hgt: 0.381351, HW: 37.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[107 37.5 14.3006], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0572026 ; 3264 816 -206.945]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0572026 ; 3264 816 -206.945]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 113.5390
Size of XDATA: [1 3264]
Size of YDATA: [1 3264]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 113.539 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.010787 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0572026
		==> Performing SF on peak body with guess "p0"=p1=[107 37.5 14.3006] and fitParamBounds=[1 0.5 0.0572026 ; 3264 816 -206.945].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[107 37.5 14.3006] and resnorm_2=.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.216304) <= resnorm (113.539) ==> Returning p1 = p1_2 ([107 37.5 14.3006])
  Columns 1 through 8
    {[1]}    {[107 37.5000 … ]}    {[107 0.3814]}    {[2 3264]}    {2×1 double}    {[84 130]}    {[0.2163]}    {9×0 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::1/1 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::1/1 Peak location estimation for Ch. 1 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (1) DIARY OF FUTURE 7 (chNum 2):
[analyzeCompositeChannel]::1/2 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::1/2 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 41 peaks (strictness: 2), of which 40 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score      Mask 
    ____    _______    ______    ________    ________    _____
    2482    0.46646    106.95      0.4041           1    true 
     319    0.46583        70     0.37962      0.9577    true 
     380    0.46142        55    0.062593     0.41497    true 
     531    0.45438        62    0.065291     0.40967    true 
     442    0.45251        93    0.052731      0.3858    true 
     770    0.45102       150    0.089286     0.44557    true 
    1124    0.44218       109    0.038275     0.34685    true 
    1038     0.4408        66    0.020039     0.31407    true 
      38    0.43619        59    0.087106     0.42111    true 
     978    0.43615       171    0.029817      0.3241    true 
     807    0.43464        37    0.021628     0.30813    true 
    1288    0.42825        57    0.097364     0.42736    true 
     617    0.42731        55    0.041459     0.33142    true 
    1188    0.42278        66     0.03362     0.31181    true 
    1884    0.41737        70     0.19537       0.578    true 
    2151    0.41504        89    0.071803      0.3656    true 
    1489    0.41005        96    0.099238     0.40504    true 
    2291    0.40646        56    0.070791     0.35187    true 
    1346    0.40495        40     0.07921       0.364    true 
    1411    0.40388        86    0.044825     0.30432    true 
    2217    0.40203        81     0.03537     0.28572    true 
    1597    0.40105       111     0.14862     0.47603    true 
    1932     0.4002        58    0.054892      0.3162    true 
    2603    0.39906        72    0.046299     0.30006    true 
    2073    0.39893        33    0.050965     0.30777    true 
    2045    0.39839        88    0.023479      0.2605    true 
    2409    0.39495    44.579     0.06693     0.32921    true 
     574    0.39313        22    0.028394     0.26145    true 
    1255    0.39026        30    0.030449      0.2609    true 
    2686     0.3857    87.052    0.064807     0.31268    true 
     247    0.38297    68.102    0.064868     0.30895    true 
    1808     0.3817        77    0.041255     0.26721    true 
    2334    0.37718        62     0.03092     0.24338    true 
      95    0.37594        54    0.061421     0.29327    true 
    2562    0.37457        29    0.021248     0.22336    true 
     134    0.33322    59.851     0.11532     0.32466    true 
    1754    0.32743        32    0.022351     0.15922    true 
    1702    0.32296        74     0.08713     0.26259    true 
    2764    0.31554    30.656     0.16056     0.37648    true 
    2818    0.30999    41.062     0.28244     0.57499    true 
     185    0.21653    19.894    0.050381    0.051353    false
[sbestimatepeakloc] > p0g: [2482 53.4757 24.9444] (hgt: 0.466462, HW: 53.4757, L/R: [2428 2536])
[sbestimatepeakloc] > Max val in peak body: 0.49692
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.419815 0.505014], HW range: [1.275 58.8233], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.535265 ; 3264 58.8233 29.7066]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.535265 ; 3264 58.8233 29.7066]
[curvefit] NumSampPoints: 109; class of XDATA: double, size of XDATA: [1 109]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 226.839, [2433.8 5.08357 29.7066]
[sbestimatepeakloc] < p1WF: [1870.47 1686.13 859.221]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 29.7066/5.08357 = 5.84365 > maxPkHgt 0.856077.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=0.177841, cfitBounds=[1 3264], p1=[1870.47 1686.13 859.221]
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 0.177841 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] >>> resnorm 0.177841 >= 100e-4 ==> Reusing old guide (guide level: 2) [2482 53.4757 24.9444]
[sbestimatepeakloc] <<< Second fitting (weighted) succeeded with p1_2=[3600.91 2565.56 1378.6] and resnorm_2=0.0710285.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.0710285) <= resnorm (0.177841) ==> Returning p1 = p1_2 ([3600.91 2565.56 1378.6])
  Columns 1 through 8
    {[1]}    {[3.6009e+03 … ]}    {[3.6009e+03 0.5373]}    {[2 3264]}    {2×1 double}    {[1027 2714]}    {[0.0710]}    {11×1688 double}
  Column 9
    {2×1688 double}
[analyzeCompositeChannel]::1/2 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::1/2 Peak location estimation for Ch. 2 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (1) DIARY OF FUTURE 9 (chNum 3):
[analyzeCompositeChannel]::1/3 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::1/3 NaN count Y0c: 0/2206464, Y1c: 0/2206464, Ycc: 0/2206464
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 12 peaks (strictness: 2), of which 8 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score      Mask 
    ____    _______    ______    ________    ________    _____
      31    0.46305       149     0.10848     0.42795    true 
     181    0.42645        61    0.073973     0.35039    true 
     285    0.40431       114    0.084798     0.33155    true 
     235    0.39351        44    0.061397     0.29696    true 
     385    0.38922        60    0.058571     0.28894    true 
     502    0.36314       107     0.14695     0.33369    true 
     582    0.32631    58.472     0.10453     0.24885    true 
     437    0.28751        20     0.02043     0.12456    true 
     704    0.22518    63.741     0.14704      0.1566    false
     792    0.20278    115.77    0.091224    0.078423    false
     673    0.19542    52.084    0.064981    0.045734    false
    2866    0.19052    88.389     0.75462        0.65    false
[sbestimatepeakloc] > p0g: [31 74.5 34.4974] (hgt: 0.463052, HW: 74.5, L/R: [1 106])
[sbestimatepeakloc] > Max val in peak body: 0.465707
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.416747 0.487532], HW range: [1.275 81.95], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.531352 ; 3264 81.95 39.9532]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.531352 ; 3264 81.95 39.9532]
[curvefit] NumSampPoints: 106; class of XDATA: double, size of XDATA: [1 106]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.270546, [53.2833 79.921 39.9532]
[sbestimatepeakloc] < p1WF: [89.1742 281.504 134.019]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 39.9532/79.921 = 0.499909 > maxPkHgt 0.491143.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=0.561899, cfitBounds=[1 3264], p1=[89.1742 281.504 134.019]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 0.561899 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [31 74.5 34.4974] (hgt: 0.463052, HW: 74.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[31 74.5 34.4974], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0694578 ; 3264 816 400.773]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0694578 ; 3264 816 400.773]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 1019.76 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] >>> resnorm 1019.76 >= 100e-4 ==> Reusing old guide (guide level: 2) [31 74.5 34.4974]
[sbestimatepeakloc] <<< Second fitting (weighted) succeeded with p1_2=[65.3354 188.111 85.7159] and resnorm_2=0.00121962.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.00121962) <= resnorm (1019.76) ==> Returning p1 = p1_2 ([65.3354 188.111 85.7159])
  Columns 1 through 8
    {[1]}    {[65.3354 … ]}    {[65.3354 0.4557]}    {[2 3264]}    {2×1 double}    {[45 179]}    {[0.0012]}    {11×135 double}
  Column 9
    {2×135 double}
[analyzeCompositeChannel]::1/3 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::1/3 Peak location estimation for Ch. 3 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[analyzeHCsP] (2) Internal (9 args)
[analyzeHCsP] (2) timePos:    31-Aug-2023 11:32:19
[analyzeHCsP] (2) Y0s class & size: uint16,         2038        3264
[analyzeHCsP] 2) Y1 class & size before crop: uint16,         2448        3264
[analyzeHCsP] (2) Num. IP points: 1631; Y1s class & size: uint16,         2038        3264
[analyzeCompositeP] (2) Size of Y0s: 2038       3264
[analyzeCompositeP] (2) Size of Y1s: 2038       3264
[analyzeCompositeP] (2) numChannels: 3
[analyzeCompositeP]::117 Class of Y0s,Y1s,Y0,Y1,Yr, ELI: int16,uint16,uint16,uint16,single, single
[analyzeCompositeP]::2/ch1 : Using supplied params "[107 37.5 14.3006]" as guess.
[analyzeCompositeP]::2/ch2 : Using supplied params "[3600.91 2565.56 1378.6]" as guess.
[analyzeCompositeP]::2/ch3 : Using supplied params "[65.3354 188.111 85.7159]" as guess.
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (2) DIARY OF FUTURE 14 (chNum 1):
[analyzeCompositeChannel]::2/1 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::2/1 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[107 37.5 14.3006], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 7 peaks (strictness: 2), of which 6 meet(s) the general height and location requirements:
    Loc      Hgt       Wid        Prm        Score     Mask 
    ___    _______    ______    ________    _______    _____
    107     0.3825        76    0.092252    0.68098    true 
    193    0.34078    81.359    0.034189    0.37987    true 
    157    0.33972        45    0.029666    0.36418    true 
     44    0.33673        27    0.025258    0.31033    true 
    356     0.2466    28.772    0.086372    0.32011    true 
    324    0.24315        65     0.02719    0.19629    true 
    443    0.17081    26.364     0.18478       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.00302032 0.362389], minmax deltaWids: [0.0133333 0.64]
[sbestimatepeakloc] > minmax deltaLocs: [0 249], maxDeltaLoc: 28.125
[sbestimatepeakloc] >> At least 1 effectively identical peak found (deltaLoc<=28.125 & deltaHgt<=0.05 & deltaWid<=0.10).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [107 38 14.5351] (hgt: 0.382502, HW: 38, L/R: [69 145])
[sbestimatepeakloc] > Max val in peak body: 0.422698
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.344252 -0.259796], HW range: [1.275 41.8], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.438922 ; 3264 41.8 -10.8595]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.438922 ; 3264 41.8 -10.8595]
[curvefit] NumSampPoints: 77; class of XDATA: double, size of XDATA: [1 77]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.355011, maxY: 0.403874, min curve y: 0.18815, max curve y: 0.381351
min Y diff: 0.0123149, max Y diff: 0.215208, min wgts1: 0, max wgts1: 0
min Y delta: -0.00140776, max Y delta: 0.000135487, min curve y delta: -0.00660405, max curve y delta: 0.00660405
min Y delta diff: -0.00680404, max Y delta diff: 0.00553177, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 0.8967
Size of XDATA: [1 77]
Size of YDATA: [1 77]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.896694, [107 38 14.5351]
[sbestimatepeakloc] < p1WF: [110.512 45.6611 20.589]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 14.5351/38 = 0.382502 > maxPkHgt -0.259796.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=14346.9, cfitBounds=[1 3264], p1=[110.512 45.6611 20.589]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 14346.9 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [107 38 14.5351] (hgt: 0.382502, HW: 38)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[107 38 14.5351], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[107 37.5 14.3006]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0573754 ; 3264 816 -211.994]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0573754 ; 3264 816 -211.994]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -0.0963737, maxY: 0.389235, min curve y: 5.37993e-05, max curve y: 0.381351
min Y diff: -0.0964275, max Y diff: 0.346816, min wgts1: 0, max wgts1: 0
min Y delta: -0.000148823, max Y delta: 0, min curve y delta: -0.00660405, max curve y delta: 0.00660405
min Y delta diff: -0.00675288, max Y delta diff: 0.00645523, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 113.1200
Size of XDATA: [1 3264]
Size of YDATA: [1 3264]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 113.12 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.00993957 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0573754
		==> Performing SF on peak body with guess "p0"=p1=[107 38 14.5351] and fitParamBounds=[1 0.5 0.0573754 ; 3264 816 -211.994].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[107 38 14.5351] and resnorm_2=.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.216923) <= resnorm (113.12) ==> Returning p1 = p1_2 ([107 38 14.5351])
  Columns 1 through 8
    {[1]}    {[107 38 14.5351]}    {[107 0.3825]}    {[2 3264]}    {2×1 double}    {[84 130]}    {[0.2169]}    {9×3264 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::2/1 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::2/1 Peak location estimation for Ch. 1 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (2) DIARY OF FUTURE 16 (chNum 2):
[analyzeCompositeChannel]::2/2 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::2/2 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[3600.91 2565.56 1378.6], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 40 peaks (strictness: 2), of which 39 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score      Mask 
    ____    _______    ______    ________    ________    _____
     319    0.46921        70     0.40179     0.67869    true 
    2482    0.46724    107.12      0.3769     0.96399    true 
     380    0.46429        55    0.062014     0.18611    true 
     531     0.4576        62    0.065181     0.21331    true 
     442    0.45595        93     0.05288     0.19919    true 
     770    0.45361       150    0.088406      0.3262    true 
    1124    0.44559       175    0.037891     0.31333    true 
      38    0.43998        59    0.087455      0.1692    true 
     978    0.43966       171    0.030139     0.27761    true 
     807    0.43779        37    0.021546     0.16871    true 
    1288    0.43156        57    0.098572     0.35594    true 
     617    0.43081        55    0.041618     0.17855    true 
    1188    0.42664        66    0.033749     0.25142    true 
    1884    0.42112        70     0.19557     0.58295    true 
    2151    0.41739        89    0.070747     0.44867    true 
    1489    0.41482        96    0.099994     0.40143    true 
    1346    0.40896        40    0.079003     0.31908    true 
    2291    0.40883        56    0.070585     0.44741    true 
    1411    0.40808        86    0.046423     0.30545    true 
    1597    0.40515       111     0.14798     0.49075    true 
    2217     0.4043        81    0.035714     0.39856    true 
    1932    0.40341        58    0.055254     0.37438    true 
    2073    0.40211        32    0.051602     0.37439    true 
    2045    0.40175        89    0.022913     0.35948    true 
    2603    0.40035        72    0.046206     0.46149    true 
     574    0.39656        22    0.028118     0.12389    true 
    2409    0.39648    44.713    0.066102     0.44723    true 
    1255    0.39411        30    0.030458     0.22584    true 
    1807    0.38813        77    0.043186     0.34458    true 
    2686    0.38672     87.22    0.063854     0.50223    true 
     247    0.38633    68.269     0.06438     0.15211    true 
      95    0.37917        54    0.059848     0.11428    true 
    2334    0.37914        62     0.03093     0.38939    true 
    2562    0.37588        29    0.021496     0.38878    true 
     134    0.33608        61     0.11556     0.18971    true 
    1754    0.33207        32     0.02284     0.26491    true 
    1702    0.32649        74    0.081193     0.36274    true 
    2764    0.31668    31.287     0.15937     0.59789    true 
    2818     0.3112    41.177     0.28255     0.78706    true 
     185    0.21954    20.114    0.051133    0.042862    false
[sbestimatepeakloc] > minmax deltaHgts: [0.126801 0.420869], minmax deltaWids: [0.965894 0.995712]
[sbestimatepeakloc] > minmax deltaLocs: [782.913 3562.91], maxDeltaLoc: 102
[sbestimatepeakloc] >>> The most prominent peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [319 35 16.4224] (hgt: 0.469212, HW: 35, L/R: [284 354])
[sbestimatepeakloc] > Max val in peak body: 0.476486
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.422291 0.49631], HW range: [1.275 38.5], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.538421 ; 3264 38.5 19.1079]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.538421 ; 3264 38.5 19.1079]
[curvefit] NumSampPoints: 71; class of XDATA: double, size of XDATA: [1 71]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.44435, maxY: 0.573451, min curve y: 0.201141, max curve y: 0.206538
min Y diff: 0.239758, max Y diff: 0.372309, min wgts1: 0, max wgts1: 0
min Y delta: -0.00569194, max Y delta: 0.00316209, min curve y delta: 0, max curve y delta: 7.83042e-05
min Y delta diff: -0.00576784, max Y delta diff: 0.00308379, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Warning: Iteration limit exceeded.  Returning results from final iteration.
> In nlinfit (line 320)
In sbsense.improc.lzcurvefit (line 374)
In sbsense.improc.sbestimatepeakloc (line 293)
In sbsense.improc.analyzeCompositeParallel>analyzeCompositeChannel (line 254)
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 1.04597, [313.95 36.4748 19.1079]
[sbestimatepeakloc] < p1WF: [675.459 1542.83 752.84]
[sbestimatepeakloc] < wres2QF1/2: [0.0195175 + 0.000185102 -> 0.0197026], [0.0254148 + 0.00016913 -> 0.0255839]
[sbestimatepeakloc] < wres2WF1/2: [0.00676966 + 0.106836 -> 0.113606], [0.000432421 + 0.000171289 -> 0.00060371]
[sbestimatepeakloc] <<< (wresnorm0WF 91.7793 > 0.5) && ((wresnorm0QF 0.0224192 <= 0.5) || (resnormQF 1.04597 <= 0.5))
		==>WFisSuperior = false
[sbestimatepeakloc] <<< QF result is superior to WF --> resnorm=0.0224192, cfitBounds=[284 354], p1=[313.95 36.4748 19.1079]
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 0.0224192 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.0278938 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.07858
		==> Performing SF on peak body with guess "p0"=p1=[313.95 36.4748 19.1079] and fitParamBounds=[1 1.275 0.538421 ; 3264 38.5 19.1079].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[317.186 38.5 18.8607] and resnorm_2=0.0914891.
[sbestimatepeakloc] <<< resnorm (0.0224192) < resorm_2(0.0914891) ==> @@@ Returning estimation [313.95 36.4748 19.1079] height: 0.523867, width: 72.9496
  Columns 1 through 8
    {[1]}    {[313.9499 … ]}    {[313.9499 0.5239]}    {[2 3264]}    {2×1 double}    {[284 354]}    {[0.0224]}    {9×71 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::2/2 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::2/2 Peak location estimation for Ch. 2 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (2) DIARY OF FUTURE 18 (chNum 3):
[analyzeCompositeChannel]::2/3 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::2/3 NaN count Y0c: 0/2206464, Y1c: 0/2206464, Ycc: 0/2206464
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[65.3354 188.111 85.7159], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 12 peaks (strictness: 2), of which 8 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score     Mask 
    ____    _______    ______    ________    _______    _____
      31    0.46441       149     0.10982    0.51713    true 
     181     0.4274        61     0.07327    0.42495    true 
     285    0.40525       114    0.085937    0.44486    true 
     235    0.39438        44     0.06273    0.39146    true 
     385    0.38896        60    0.058806    0.37735    true 
     502    0.36256       107     0.14359    0.44508    true 
     582    0.32643    58.523     0.10389    0.36805    true 
     437    0.28764        20     0.02017    0.29071    true 
     704    0.22289    64.131     0.14451    0.35695    false
     791    0.20036     151.3    0.089372    0.34716    false
     673    0.19432    52.178    0.064733    0.28622    false
    2866    0.18993    87.607     0.75472       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.0191918 0.368741], minmax deltaWids: [0.603958 0.94684]
[sbestimatepeakloc] > minmax deltaLocs: [34.3354 516.665], maxDeltaLoc: 102
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=80).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [31 74.5 34.5986] (hgt: 0.46441, HW: 74.5, L/R: [1 106])
[sbestimatepeakloc] > Max val in peak body: 0.467068
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.417969 0.488959], HW range: [1.275 81.95], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.532911 ; 3264 81.95 40.0702]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.532911 ; 3264 81.95 40.0702]
[curvefit] NumSampPoints: 106; class of XDATA: double, size of XDATA: [1 106]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.458004, maxY: 0.461462, min curve y: 0.407948, max curve y: 0.455664
min Y diff: 0.00243842, max Y diff: 0.053514, min wgts1: 0, max wgts1: 0
min Y delta: -8.82929e-05, max Y delta: 3.04565e-05, min curve y delta: -0.000946154, max curve y delta: 0.001322
min Y delta diff: -0.00141029, max Y delta diff: 0.00097661, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Warning: Iteration limit exceeded.  Returning results from final iteration.
> In nlinfit (line 320)
In sbsense.improc.lzcurvefit (line 374)
In sbsense.improc.sbestimatepeakloc (line 293)
In sbsense.improc.analyzeCompositeParallel>analyzeCompositeChannel (line 254)
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.27461, [53.1727 79.9323 40.0702]
[sbestimatepeakloc] < p1WF: [89.1658 280.049 133.774]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 40.0702/79.9323 = 0.501302 > maxPkHgt 0.491735.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=0.563153, cfitBounds=[1 3264], p1=[89.1658 280.049 133.774]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 0.563153 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [31 74.5 34.5986] (hgt: 0.46441, HW: 74.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[31 74.5 34.5986], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[65.3354 188.111 85.7159]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0696616 ; 3264 816 401.256]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0696616 ; 3264 816 401.256]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -1.08234, maxY: 0.287717, min curve y: 0.00157051, max curve y: 0.455664
min Y diff: -1.08391, max Y diff: 0.0118265, min wgts1: 0, max wgts1: 1
min Y delta: -0.000419877, max Y delta: 0, min curve y delta: -0.00157331, max curve y delta: 0.001322
min Y delta diff: -0.00174187, max Y delta diff: 0.00115343, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0.05
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 1012.39 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] >>> resnorm 1012.39 >= 100e-4 ==> Reusing old guide (guide level: 3) [31 74.5 34.5986]
[sbestimatepeakloc] <<< Second fitting (weighted) succeeded with p1_2=[65.5351 186.288 85.203] and resnorm_2=0.00123034.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.00123034) <= resnorm (1012.39) ==> Returning p1 = p1_2 ([65.5351 186.288 85.203])
  Columns 1 through 8
    {[1]}    {[65.5351 … ]}    {[65.5351 0.4574]}    {[2 3264]}    {2×1 double}    {[45 179]}    {[0.0012]}    {11×135 double}
  Column 9
    {2×135 double}
[analyzeCompositeChannel]::2/3 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::2/3 Peak location estimation for Ch. 3 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[analyzeHCsP] (3) Internal (9 args)
[analyzeHCsP] (3) timePos:    31-Aug-2023 11:32:20
[analyzeHCsP] (3) Y0s class & size: uint16,         2038        3264
[analyzeHCsP] 3) Y1 class & size before crop: uint16,         2448        3264
[analyzeHCsP] (3) Num. IP points: 1631; Y1s class & size: uint16,         2038        3264
[analyzeCompositeP] (3) Size of Y0s: 2038       3264
[analyzeCompositeP] (3) Size of Y1s: 2038       3264
[analyzeCompositeP] (3) numChannels: 3
[analyzeCompositeP]::117 Class of Y0s,Y1s,Y0,Y1,Yr, ELI: int16,uint16,uint16,uint16,single, single
[analyzeCompositeP]::3/ch1 : Using supplied params "[107 38 14.5351]" as guess.
[analyzeCompositeP]::3/ch2 : Using supplied params "[313.95 36.4748 19.1079]" as guess.
[analyzeCompositeP]::3/ch3 : Using supplied params "[65.5351 186.288 85.203]" as guess.
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (3) DIARY OF FUTURE 25 (chNum 2):
[analyzeCompositeChannel]::3/2 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::3/2 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[313.95 36.4748 19.1079], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 40 peaks (strictness: 2), of which 39 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score      Mask 
    ____    _______    ______    ________    ________    _____
     319     0.4693        70     0.40448           1    true 
    2482    0.46699    107.11     0.37718     0.61032    true 
     380    0.46406        55    0.062051     0.48553    true 
     531    0.45761        62    0.065341     0.47107    true 
     442     0.4559        93    0.052924     0.45881    true 
     770     0.4533       150    0.088411      0.4143    true 
    1124    0.44537       175    0.037769     0.26596    true 
      38     0.4403        59    0.087651     0.48629    true 
     979    0.43942       171    0.030138     0.27805    true 
     807     0.4376        37    0.021433     0.34022    true 
    1288    0.43108        57    0.097119     0.39046    true 
     617    0.43096        55    0.041981     0.41045    true 
    1188    0.42637        66     0.03374     0.32013    true 
    1885    0.42103        70     0.19571     0.44947    true 
    2151    0.41714        89    0.070979     0.21874    true 
    1513    0.41513        96     0.10082      0.3512    true 
    1346    0.40898        40    0.078839     0.33485    true 
    2291    0.40859        56    0.070021     0.19286    true 
    1411     0.4083        86    0.047511     0.29573    true 
    1597    0.40528       111     0.14868     0.39218    true 
    2217    0.40399        81    0.035354      0.1598    true 
    1932    0.40371        58    0.055168     0.22548    true 
    2045     0.4017        89    0.051339     0.20148    true 
    2073    0.40169        32    0.023167       0.137    true 
    2603    0.39973        72    0.046594     0.12224    true 
     574     0.3961        22    0.028488     0.36004    true 
    2409    0.39579    44.704     0.06661     0.15712    true 
    1255    0.39399        30    0.031231     0.26738    true 
    1807    0.39307        77    0.046166     0.23657    true 
     247    0.38619    68.206     0.06465     0.47455    true 
    2686    0.38602    87.235    0.063129     0.11848    true 
      95    0.37935        54    0.060113     0.43169    true 
    2334    0.37872        62    0.030936     0.12543    true 
    2562    0.37531        29    0.021874    0.050811    true 
     134    0.33554        61      0.1148     0.50753    true 
    1754    0.33223        32    0.023083     0.16241    true 
    1702    0.32333        74    0.077928     0.27786    true 
    2764    0.31499    31.604     0.15809     0.19869    true 
    2819    0.30904    41.287     0.27989     0.37111    true 
     185     0.2196    19.924    0.049826     0.35184    false
[sbestimatepeakloc] > minmax deltaHgts: [0.104164 0.410072], minmax deltaWids: [0.0130167 1.39892]
[sbestimatepeakloc] > minmax deltaLocs: [5.05011 2505.05], maxDeltaLoc: 27.3561
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=36.4748).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [319 35 16.4255] (hgt: 0.469299, HW: 35, L/R: [284 354])
[sbestimatepeakloc] > Max val in peak body: 0.476192
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.422369 0.49621], HW range: [1.275 38.5], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.538521 ; 3264 38.5 19.1041]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.538521 ; 3264 38.5 19.1041]
[curvefit] NumSampPoints: 71; class of XDATA: double, size of XDATA: [1 71]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.438331, maxY: 0.607167, min curve y: 0.237511, max curve y: 0.523866
min Y diff: -0.0707749, max Y diff: 0.294266, min wgts1: 0, max wgts1: 0
min Y delta: -0.00751955, max Y delta: 0.00429831, min curve y delta: -0.00932368, max curve y delta: 0.00932503
min Y delta diff: -0.0160184, max Y delta diff: 0.0110677, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Warning: Iteration limit exceeded.  Returning results from final iteration.
> In nlinfit (line 320)
In sbsense.improc.lzcurvefit (line 374)
In sbsense.improc.sbestimatepeakloc (line 293)
In sbsense.improc.analyzeCompositeParallel>analyzeCompositeChannel (line 254)
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 1.19476, [312.356 36.2294 19.1041]
[sbestimatepeakloc] < p1WF: [674.744 1538.49 750.932]
[sbestimatepeakloc] < wres2QF1/2: [0.0187059 + 0.000186325 -> 0.0188922], [0.0249698 + 0.000170166 -> 0.02514]
[sbestimatepeakloc] < wres2WF1/2: [0.00687813 + 0.108011 -> 0.114889], [0.000427418 + 0.000172382 -> 0.0005998]
[sbestimatepeakloc] <<< (wresnorm0WF 92.8134 > 0.5) && ((wresnorm0QF 0.0217886 <= 0.5) || (resnormQF 1.19476 <= 0.5))
		==>WFisSuperior = false
[sbestimatepeakloc] <<< QF result is superior to WF --> resnorm=0.0217886, cfitBounds=[284 354], p1=[312.356 36.2294 19.1041]
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 0.0217886 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.0331574 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0790963
		==> Performing SF on peak body with guess "p0"=p1=[312.356 36.2294 19.1041] and fitParamBounds=[1 1.275 0.538521 ; 3264 38.5 19.1041].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[315.643 38.5 18.7629] and resnorm_2=0.0958259.
[sbestimatepeakloc] <<< resnorm (0.0217886) < resorm_2(0.0958259) ==> @@@ Returning estimation [312.356 36.2294 19.1041] height: 0.527309, width: 72.4589
  Columns 1 through 8
    {[1]}    {[312.3561 … ]}    {[312.3561 0.5273]}    {[2 3264]}    {2×1 double}    {[284 354]}    {[0.0218]}    {9×71 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::3/2 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::3/2 Peak location estimation for Ch. 2 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (3) DIARY OF FUTURE 23 (chNum 1):
[analyzeCompositeChannel]::3/1 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::3/1 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[107 38 14.5351], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 7 peaks (strictness: 2), of which 6 meet(s) the general height and location requirements:
    Loc      Hgt       Wid        Prm        Score     Mask 
    ___    _______    ______    ________    _______    _____
    107    0.38218        76    0.092554    0.68328    true 
    193    0.34074    82.777    0.034721     0.3841    true 
    157    0.33888        45    0.028727    0.36431    true 
     44    0.33636        27    0.025559    0.31634    true 
    356    0.24971    37.779    0.088193    0.34152    true 
    319    0.24007        56    0.023815     0.1792    true 
    443     0.1696    25.861     0.18588       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.000844075 0.372366], minmax deltaWids: [0 0.644737]
[sbestimatepeakloc] > minmax deltaLocs: [0 249], maxDeltaLoc: 28.5
[sbestimatepeakloc] >> At least 1 effectively identical peak found (deltaLoc<=28.5 & deltaHgt<=0.05 & deltaWid<=0.10).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [107 38 14.5228] (hgt: 0.38218, HW: 38, L/R: [69 145])
[sbestimatepeakloc] > Max val in peak body: 0.422405
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.343962 -0.262111], HW range: [1.275 41.8], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.438551 ; 3264 41.8 -10.9563]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.438551 ; 3264 41.8 -10.9563]
[curvefit] NumSampPoints: 77; class of XDATA: double, size of XDATA: [1 77]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.354529, maxY: 0.403304, min curve y: 0.191251, max curve y: 0.382502
min Y diff: 0.0106869, max Y diff: 0.211501, min wgts1: 0, max wgts1: 0
min Y delta: -0.00140991, max Y delta: 0.000140865, min curve y delta: -0.00653509, max curve y delta: 0.00653509
min Y delta diff: -0.00672562, max Y delta diff: 0.00545657, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 0.8926
Size of XDATA: [1 77]
Size of YDATA: [1 77]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.892579, [107 38 14.5228]
[sbestimatepeakloc] < p1WF: [110.429 45.5267 20.5129]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 14.5228/38 = 0.38218 > maxPkHgt -0.262111.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=14425, cfitBounds=[1 3264], p1=[110.429 45.5267 20.5129]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 14425 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [107 38 14.5228] (hgt: 0.38218, HW: 38)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[107 38 14.5228], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[107 38 14.5351]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0573269 ; 3264 816 -213.883]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0573269 ; 3264 816 -213.883]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -0.0980127, maxY: 0.388384, min curve y: 5.54101e-05, max curve y: 0.382502
min Y diff: -0.0980681, max Y diff: 0.344824, min wgts1: 0, max wgts1: 0
min Y delta: -0.000149064, max Y delta: 0, min curve y delta: -0.00653509, max curve y delta: 0.00653509
min Y delta diff: -0.00668415, max Y delta diff: 0.00638602, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 112.2257
Size of XDATA: [1 3264]
Size of YDATA: [1 3264]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 112.226 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.00995822 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0573269
		==> Performing SF on peak body with guess "p0"=p1=[107 38 14.5228] and fitParamBounds=[1 0.5 0.0573269 ; 3264 816 -213.883].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[107 38 14.5228] and resnorm_2=.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.216367) <= resnorm (112.226) ==> Returning p1 = p1_2 ([107 38 14.5228])
  Columns 1 through 8
    {[1]}    {[107 38 14.5228]}    {[107 0.3822]}    {[2 3264]}    {2×1 double}    {[84 130]}    {[0.2164]}    {9×3264 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::3/1 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::3/1 Peak location estimation for Ch. 1 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (3) DIARY OF FUTURE 27 (chNum 3):
[analyzeCompositeChannel]::3/3 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::3/3 NaN count Y0c: 0/2206464, Y1c: 0/2206464, Ycc: 0/2206464
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[65.5351 186.288 85.203], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 12 peaks (strictness: 2), of which 8 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score     Mask 
    ____    _______    ______    ________    _______    _____
      31    0.46387       149     0.10885    0.51646    true 
     181     0.4275        62    0.073361     0.4238    true 
     285    0.40471       114    0.085976    0.44355    true 
     235    0.39359        43    0.062838    0.38889    true 
     385    0.38853        60    0.058616     0.3754    true 
     502    0.36192       107     0.14453    0.44468    true 
     582    0.32594     58.54     0.10354    0.36636    true 
     437    0.28834        20    0.020351    0.28936    true 
     704    0.22203     62.98     0.14353    0.35464    false
     792    0.20047    115.52    0.093664     0.3301    false
     672    0.19603    51.804    0.066377      0.287    false
    2865    0.18993    88.031     0.75268       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.0141956 0.369567], minmax deltaWids: [0.600081 0.94632]
[sbestimatepeakloc] > minmax deltaLocs: [34.5351 516.465], maxDeltaLoc: 102
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=80).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [31 74.5 34.558] (hgt: 0.463866, HW: 74.5, L/R: [1 106])
[sbestimatepeakloc] > Max val in peak body: 0.466673
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.417479 0.488463], HW range: [1.275 81.95], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.532286 ; 3264 81.95 40.0295]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.532286 ; 3264 81.95 40.0295]
[curvefit] NumSampPoints: 106; class of XDATA: double, size of XDATA: [1 106]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.457681, maxY: 0.462247, min curve y: 0.408365, max curve y: 0.45737
min Y diff: 0.000354974, max Y diff: 0.0538822, min wgts1: 0, max wgts1: 0
min Y delta: -0.000125732, max Y delta: 5.68198e-05, min curve y delta: -0.00096277, max curve y delta: 0.00135002
min Y delta diff: -0.00147575, max Y delta diff: 0.00101959, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Warning: Iteration limit exceeded.  Returning results from final iteration.
> In nlinfit (line 320)
In sbsense.improc.lzcurvefit (line 374)
In sbsense.improc.sbestimatepeakloc (line 293)
In sbsense.improc.analyzeCompositeParallel>analyzeCompositeChannel (line 254)
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.278063, [53.1095 79.8712 40.0295]
[sbestimatepeakloc] < p1WF: [88.9331 280.065 133.593]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 40.0295/79.8712 = 0.501176 > maxPkHgt 0.491466.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=0.562465, cfitBounds=[1 3264], p1=[88.9331 280.065 133.593]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 0.562465 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [31 74.5 34.558] (hgt: 0.463866, HW: 74.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[31 74.5 34.558], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[65.5351 186.288 85.203]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0695799 ; 3264 816 401.036]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0695799 ; 3264 816 401.036]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -1.06427, maxY: 0.289451, min curve y: 0.00154627, max curve y: 0.45737
min Y diff: -1.06582, max Y diff: 0.016735, min wgts1: 0, max wgts1: 1
min Y delta: -0.00041487, max Y delta: 0, min curve y delta: -0.00159467, max curve y delta: 0.00135002
min Y delta diff: -0.00176489, max Y delta diff: 0.0011798, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0.05
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 974.449 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] >>> resnorm 974.449 >= 100e-4 ==> Reusing old guide (guide level: 3) [31 74.5 34.558]
[sbestimatepeakloc] <<< Second fitting (weighted) succeeded with p1_2=[65.7303 186.872 85.3758] and resnorm_2=0.00125785.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.00125785) <= resnorm (974.449) ==> Returning p1 = p1_2 ([65.7303 186.872 85.3758])
  Columns 1 through 8
    {[1]}    {[65.7303 … ]}    {[65.7303 0.4569]}    {[2 3264]}    {2×1 double}    {[45 183]}    {[0.0013]}    {11×139 double}
  Column 9
    {2×139 double}
[analyzeCompositeChannel]::3/3 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::3/3 Peak location estimation for Ch. 3 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[analyzeHCsP] (4) Internal (9 args)
[analyzeHCsP] (4) timePos:    31-Aug-2023 11:32:21
[analyzeHCsP] (4) Y0s class & size: uint16,         2038        3264
[analyzeHCsP] 4) Y1 class & size before crop: uint16,         2448        3264
[analyzeHCsP] (4) Num. IP points: 1631; Y1s class & size: uint16,         2038        3264
[analyzeCompositeP] (4) Size of Y0s: 2038       3264
[analyzeCompositeP] (4) Size of Y1s: 2038       3264
[analyzeCompositeP] (4) numChannels: 3
[analyzeCompositeP]::117 Class of Y0s,Y1s,Y0,Y1,Yr, ELI: int16,uint16,uint16,uint16,single, single
[analyzeCompositeP]::4/ch1 : Using supplied params "[107 38 14.5228]" as guess.
[analyzeCompositeP]::4/ch2 : Using supplied params "[312.356 36.2294 19.1041]" as guess.
[analyzeCompositeP]::4/ch3 : Using supplied params "[65.7303 186.872 85.3758]" as guess.
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (4) DIARY OF FUTURE 32 (chNum 1):
[analyzeCompositeChannel]::4/1 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::4/1 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[107 38 14.5228], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 7 peaks (strictness: 2), of which 6 meet(s) the general height and location requirements:
    Loc      Hgt       Wid        Prm        Score     Mask 
    ___    _______    ______    ________    _______    _____
    107    0.38119        76    0.093111    0.67012    true 
    193    0.33917    81.894    0.034082    0.37607    true 
    157    0.33688        45    0.027691    0.35488    true 
     44    0.33511        28    0.026109    0.31435    true 
    355    0.23954    30.261    0.080667     0.2911    true 
    319    0.23936        64    0.025504    0.19008    true 
    443    0.16938    25.271     0.19443       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.00259415 0.373704], minmax deltaWids: [0 0.631579]
[sbestimatepeakloc] > minmax deltaLocs: [0 248], maxDeltaLoc: 28.5
[sbestimatepeakloc] >> At least 1 effectively identical peak found (deltaLoc<=28.5 & deltaHgt<=0.05 & deltaWid<=0.10).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [107 38 14.4851] (hgt: 0.381188, HW: 38, L/R: [69 145])
[sbestimatepeakloc] > Max val in peak body: 0.420746
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.343069 -0.268252], HW range: [1.275 41.8], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.437413 ; 3264 41.8 -11.213]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.437413 ; 3264 41.8 -11.213]
[curvefit] NumSampPoints: 77; class of XDATA: double, size of XDATA: [1 77]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.353916, maxY: 0.402094, min curve y: 0.19109, max curve y: 0.38218
min Y diff: 0.0126463, max Y diff: 0.208187, min wgts1: 0, max wgts1: 0
min Y delta: -0.00156161, max Y delta: 0.000367905, min curve y delta: -0.00652957, max curve y delta: 0.00652957
min Y delta diff: -0.00657893, max Y delta diff: 0.00538522, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 0.8955
Size of XDATA: [1 77]
Size of YDATA: [1 77]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.895457, [107 38 14.4851]
[sbestimatepeakloc] < p1WF: [110.228 45.1596 20.2973]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 14.4851/38 = 0.381188 > maxPkHgt -0.268252.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=14489.7, cfitBounds=[1 3264], p1=[110.228 45.1596 20.2973]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 14489.7 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [107 38 14.4851] (hgt: 0.381188, HW: 38)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[107 38 14.4851], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[107 38 14.5228]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0571782 ; 3264 816 -218.894]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0571782 ; 3264 816 -218.894]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -0.103573, maxY: 0.387309, min curve y: 5.53634e-05, max curve y: 0.38218
min Y diff: -0.103628, max Y diff: 0.343786, min wgts1: 0, max wgts1: 0
min Y delta: -0.000150439, max Y delta: 0, min curve y delta: -0.00652957, max curve y delta: 0.00652957
min Y delta diff: -0.00668001, max Y delta diff: 0.00637913, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 110.4459
Size of XDATA: [1 3264]
Size of YDATA: [1 3264]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 110.446 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.00990343 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0571782
		==> Performing SF on peak body with guess "p0"=p1=[107 38 14.4851] and fitParamBounds=[1 0.5 0.0571782 ; 3264 816 -218.894].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[107 38 14.4851] and resnorm_2=.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.214172) <= resnorm (110.446) ==> Returning p1 = p1_2 ([107 38 14.4851])
  Columns 1 through 8
    {[1]}    {[107 38 14.4851]}    {[107 0.3812]}    {[2 3264]}    {2×1 double}    {[84 130]}    {[0.2142]}    {9×3264 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::4/1 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::4/1 Peak location estimation for Ch. 1 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (4) DIARY OF FUTURE 34 (chNum 2):
[analyzeCompositeChannel]::4/2 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::4/2 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[312.356 36.2294 19.1041], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 40 peaks (strictness: 2), of which 39 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score      Mask 
    ____    _______    ______    ________    ________    _____
     319    0.46834        70     0.41156           1    true 
    2482    0.46597    107.09      0.3777     0.60126    true 
     380    0.46291        55    0.062204     0.48437    true 
     531    0.45667        62    0.065629     0.47004    true 
     442    0.45484        93    0.053238     0.45739    true 
     770    0.45208       150    0.088402     0.41194    true 
    1124    0.44435       175    0.037921     0.26537    true 
      38    0.43908        60    0.086398     0.48377    true 
     979    0.43826       171    0.029889     0.27702    true 
     807     0.4366        37    0.021741     0.34054    true 
    1288    0.42991        57    0.096528     0.38744    true 
     617     0.4299        55    0.041927      0.4096    true 
    1188    0.42532        66    0.033816      0.3196    true 
    1885    0.42024        70     0.19428     0.44284    true 
    1513    0.41706        96     0.10426     0.35407    true 
    2151    0.41612        89    0.070852     0.21633    true 
    1346    0.40787        40    0.078647     0.33304    true 
    2291    0.40749        56    0.069801     0.19112    true 
    1411    0.40747        86    0.047854     0.29462    true 
    1597    0.40458       111     0.14998     0.39015    true 
    2217    0.40267        81    0.035248     0.15818    true 
    1932    0.40245        58    0.054464     0.22337    true 
    2045    0.40047        89    0.050256     0.19818    true 
    2073    0.40046        32    0.023642     0.13757    true 
    2603    0.39839        72    0.046405     0.12096    true 
     574    0.39458        22    0.029009     0.36051    true 
    2409    0.39404    44.655    0.066346     0.15528    true 
    1255    0.39278        30     0.03187       0.268    true 
    1807     0.3913        77    0.045202     0.23332    true 
    2686     0.3849    87.177    0.063517     0.11708    true 
     247    0.38481     67.84     0.06447     0.47303    true 
      95    0.37804        53     0.05934     0.42909    true 
    2334     0.3776        62    0.030851     0.12487    true 
    2562    0.37412        29    0.021957    0.050957    true 
     134    0.33376        61      0.1147     0.50519    true 
    1754    0.33101        32    0.023172     0.16259    true 
    1702    0.31984        74    0.079646     0.27717    true 
    2764    0.31336    31.408     0.15747     0.19426    true 
    2819    0.30635    41.235      0.2793      0.3634    true 
     185    0.21704    19.643    0.048402     0.34934    false
[sbestimatepeakloc] > minmax deltaHgts: [0.111838 0.419033], minmax deltaWids: [0.00633262 1.41516]
[sbestimatepeakloc] > minmax deltaLocs: [6.64392 2506.64], maxDeltaLoc: 27.1721
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=36.2294).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [319 35 16.3918] (hgt: 0.468336, HW: 35, L/R: [284 354])
[sbestimatepeakloc] > Max val in peak body: 0.475198
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.421502 0.495184], HW range: [1.275 38.5], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.537416 ; 3264 38.5 19.0646]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.537416 ; 3264 38.5 19.0646]
[curvefit] NumSampPoints: 71; class of XDATA: double, size of XDATA: [1 71]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.425715, maxY: 0.671658, min curve y: 0.227167, max curve y: 0.527258
min Y diff: -0.0779984, max Y diff: 0.344663, min wgts1: 0, max wgts1: 0
min Y delta: -0.0110498, max Y delta: 0.00647355, min curve y delta: -0.00945141, max curve y delta: 0.00945215
min Y delta diff: -0.0198893, max Y delta diff: 0.0127792, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Warning: Iteration limit exceeded.  Returning results from final iteration.
> In nlinfit (line 320)
In sbsense.improc.lzcurvefit (line 374)
In sbsense.improc.sbestimatepeakloc (line 293)
In sbsense.improc.analyzeCompositeParallel>analyzeCompositeChannel (line 254)
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 1.48861, [309.009 35.4535 19.0646]
[sbestimatepeakloc] < p1WF: [672.643 1533.04 746.536]
[sbestimatepeakloc] < wres2QF1/2: [0.0167408 + 0.000188249 -> 0.016929], [0.0233236 + 0.000171647 -> 0.0234952]
[sbestimatepeakloc] < wres2WF1/2: [0.00707541 + 0.10929 -> 0.116365], [0.000419244 + 0.000173942 -> 0.000593186]
[sbestimatepeakloc] <<< (wresnorm0WF 94.0051 > 0.5) && ((wresnorm0QF 0.0199749 <= 0.5) || (resnormQF 1.48861 <= 0.5))
		==>WFisSuperior = false
[sbestimatepeakloc] <<< QF result is superior to WF --> resnorm=0.0199749, cfitBounds=[284 354], p1=[309.009 35.4535 19.0646]
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 0.0199749 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.0551944 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0806602
		==> Performing SF on peak body with guess "p0"=p1=[309.009 35.4535 19.0646] and fitParamBounds=[1 1.275 0.537416 ; 3264 38.5 19.0646].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[314.953 38.5 18.456] and resnorm_2=0.110663.
[sbestimatepeakloc] <<< resnorm (0.0199749) < resorm_2(0.110663) ==> @@@ Returning estimation [309.009 35.4535 19.0646] height: 0.537734, width: 70.907
  Columns 1 through 8
    {[1]}    {[309.0089 … ]}    {[309.0089 0.5377]}    {[2 3264]}    {2×1 double}    {[284 354]}    {[0.0200]}    {9×71 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::4/2 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::4/2 Peak location estimation for Ch. 2 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (4) DIARY OF FUTURE 36 (chNum 3):
[analyzeCompositeChannel]::4/3 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::4/3 NaN count Y0c: 0/2206464, Y1c: 0/2206464, Ycc: 0/2206464
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[65.7303 186.872 85.3758], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 12 peaks (strictness: 2), of which 8 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score     Mask 
    ____    _______    ______    ________    _______    _____
      31    0.46281       149     0.10989    0.51451    true 
     181    0.42663        62    0.074762    0.42287    true 
     285    0.40322       114    0.086386     0.4414    true 
     235    0.39265        43    0.063199     0.3875    true 
     385    0.38736        60    0.058845    0.37397    true 
     502    0.36035       107     0.14575     0.4414    true 
     582    0.32443    58.918     0.10313     0.3633    true 
     437    0.28748        20    0.020574    0.28915    true 
     704    0.22157    62.825     0.13985    0.34811    false
     792    0.19925    111.79    0.094519    0.32606    false
     672    0.19545    51.741    0.066925    0.28578    false
    2865    0.18915    88.766     0.78209       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.0130146 0.370749], minmax deltaWids: [0.601331 0.946487]
[sbestimatepeakloc] > minmax deltaLocs: [34.7303 516.27], maxDeltaLoc: 102
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=80).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [31 74.5 34.4797] (hgt: 0.462814, HW: 74.5, L/R: [1 106])
[sbestimatepeakloc] > Max val in peak body: 0.465542
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.416533 0.487319], HW range: [1.275 81.95], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.53108 ; 3264 81.95 39.9358]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.53108 ; 3264 81.95 39.9358]
[curvefit] NumSampPoints: 106; class of XDATA: double, size of XDATA: [1 106]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.45599, maxY: 0.457957, min curve y: 0.407924, max curve y: 0.456868
min Y diff: 0.000843773, max Y diff: 0.0490638, min wgts1: 0, max wgts1: 0
min Y delta: -6.32643e-05, max Y delta: 4.42652e-05, min curve y delta: -0.000952372, max curve y delta: 0.00134424
min Y delta diff: -0.00129998, max Y delta diff: 0.000889107, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.263849, [53.3926 79.8623 39.9358]
[sbestimatepeakloc] < p1WF: [88.9292 278.436 132.576]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 39.9358/79.8623 = 0.500058 > maxPkHgt 0.48843.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=0.563493, cfitBounds=[1 3264], p1=[88.9292 278.436 132.576]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 0.563493 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [31 74.5 34.4797] (hgt: 0.462814, HW: 74.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[31 74.5 34.4797], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[65.7303 186.872 85.3758]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0694222 ; 3264 816 398.559]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0694222 ; 3264 816 398.559]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -1.07419, maxY: 0.287416, min curve y: 0.00155442, max curve y: 0.456868
min Y diff: -1.07574, max Y diff: 0.0132179, min wgts1: 0, max wgts1: 1
min Y delta: -0.000417286, max Y delta: 0, min curve y delta: -0.00158795, max curve y delta: 0.00134424
min Y delta diff: -0.00176153, max Y delta diff: 0.00117066, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0.05
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 995.915 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] >>> resnorm 995.915 >= 100e-4 ==> Reusing old guide (guide level: 3) [31 74.5 34.4797]
[sbestimatepeakloc] <<< Second fitting (weighted) succeeded with p1_2=[65.3285 187.013 85.2448] and resnorm_2=0.00124916.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.00124916) <= resnorm (995.915) ==> Returning p1 = p1_2 ([65.3285 187.013 85.2448])
  Columns 1 through 8
    {[1]}    {[65.3285 … ]}    {[65.3285 0.4558]}    {[2 3264]}    {2×1 double}    {[45 180]}    {[0.0012]}    {11×136 double}
  Column 9
    {2×136 double}
[analyzeCompositeChannel]::4/3 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::4/3 Peak location estimation for Ch. 3 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[analyzeHCsP] (5) Internal (9 args)
[analyzeHCsP] (5) timePos:    31-Aug-2023 11:32:22
[analyzeHCsP] (5) Y0s class & size: uint16,         2038        3264
[analyzeHCsP] 5) Y1 class & size before crop: uint16,         2448        3264
[analyzeHCsP] (5) Num. IP points: 1631; Y1s class & size: uint16,         2038        3264
[analyzeCompositeP] (5) Size of Y0s: 2038       3264
[analyzeCompositeP] (5) Size of Y1s: 2038       3264
[analyzeCompositeP] (5) numChannels: 3
[analyzeCompositeP]::117 Class of Y0s,Y1s,Y0,Y1,Yr, ELI: int16,uint16,uint16,uint16,single, single
[analyzeCompositeP]::5/ch1 : Using supplied params "[107 38 14.4851]" as guess.
[analyzeCompositeP]::5/ch2 : Using supplied params "[309.009 35.4535 19.0646]" as guess.
[analyzeCompositeP]::5/ch3 : Using supplied params "[65.3285 187.013 85.2448]" as guess.
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (5) DIARY OF FUTURE 41 (chNum 1):
[analyzeCompositeChannel]::5/1 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::5/1 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[107 38 14.4851], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 7 peaks (strictness: 2), of which 6 meet(s) the general height and location requirements:
    Loc      Hgt       Wid        Prm        Score     Mask 
    ___    _______    ______    ________    _______    _____
    107     0.3819        75    0.092966    0.68246    true 
    193    0.34067    80.659    0.034774       0.39    true 
     44    0.33613        29    0.027066    0.32735    true 
    157    0.33552        45    0.026168    0.35782    true 
    321    0.24434        65    0.086695    0.40477    true 
    355    0.23606    28.934    0.023419    0.11036    true 
    444    0.16798    24.811     0.18797       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.00185442 0.380722], minmax deltaWids: [0.0131579 0.61929]
[sbestimatepeakloc] > minmax deltaLocs: [0 248], maxDeltaLoc: 28.5
[sbestimatepeakloc] >> At least 1 effectively identical peak found (deltaLoc<=28.5 & deltaHgt<=0.05 & deltaWid<=0.10).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [107 37.5 14.3211] (hgt: 0.381895, HW: 37.5, L/R: [69 145])
[sbestimatepeakloc] > Max val in peak body: 0.421072
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.343706 -0.265222], HW range: [1.275 41.25], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.438225 ; 3264 41.25 -10.9404]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.438225 ; 3264 41.25 -10.9404]
[curvefit] NumSampPoints: 77; class of XDATA: double, size of XDATA: [1 77]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.353666, maxY: 0.402579, min curve y: 0.190594, max curve y: 0.381188
min Y diff: 0.0140617, max Y diff: 0.209054, min wgts1: 0, max wgts1: 0
min Y delta: -0.00158912, max Y delta: 0.000379082, min curve y delta: -0.00651263, max curve y delta: 0.00651263
min Y delta diff: -0.00655964, max Y delta diff: 0.0053496, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 0.9207
Size of XDATA: [1 77]
Size of YDATA: [1 77]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.920743, [107 37.5 14.3211]
[sbestimatepeakloc] < p1WF: [110.015 45.2363 20.3376]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 14.3211/37.5 = 0.381895 > maxPkHgt -0.265222.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=14418.4, cfitBounds=[1 3264], p1=[110.015 45.2363 20.3376]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 14418.4 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [107 37.5 14.3211] (hgt: 0.381895, HW: 37.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[107 37.5 14.3211], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[107 38 14.4851]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0572843 ; 3264 816 -216.421]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0572843 ; 3264 816 -216.421]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -0.10507, maxY: 0.388248, min curve y: 5.52198e-05, max curve y: 0.381188
min Y diff: -0.105125, max Y diff: 0.344838, min wgts1: 0, max wgts1: 0
min Y delta: -0.000151185, max Y delta: 0, min curve y delta: -0.00651263, max curve y delta: 0.00651263
min Y delta diff: -0.00666382, max Y delta diff: 0.00636145, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 110.9753
Size of XDATA: [1 3264]
Size of YDATA: [1 3264]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 110.975 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.010348 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0572843
		==> Performing SF on peak body with guess "p0"=p1=[107 37.5 14.3211] and fitParamBounds=[1 0.5 0.0572843 ; 3264 816 -216.421].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[107 37.5 14.3211] and resnorm_2=.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.216149) <= resnorm (110.975) ==> Returning p1 = p1_2 ([107 37.5 14.3211])
  Columns 1 through 8
    {[1]}    {[107 37.5000 … ]}    {[107 0.3819]}    {[2 3264]}    {2×1 double}    {[84 130]}    {[0.2161]}    {9×3264 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::5/1 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::5/1 Peak location estimation for Ch. 1 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (5) DIARY OF FUTURE 43 (chNum 2):
[analyzeCompositeChannel]::5/2 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::5/2 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[309.009 35.4535 19.0646], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 41 peaks (strictness: 2), of which 40 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score      Mask 
    ____    _______    ______    ________    ________    _____
     319    0.46852        70     0.41571           1    true 
    2482    0.46612     107.1     0.37824     0.59413    true 
     380    0.46283        55    0.062024     0.48516    true 
     531    0.45692        62    0.066118     0.47199    true 
     442     0.4549        93    0.053459     0.45642    true 
     771    0.45203       150    0.088063     0.40809    true 
    1124    0.44451       110    0.037965      0.3155    true 
    1038    0.44343        65    0.020105     0.33011    true 
      38    0.43888        60    0.085948     0.48483    true 
     979    0.43835       171     0.02997     0.27475    true 
     807    0.43693        37    0.021869     0.34245    true 
     617    0.42998        55    0.041796     0.41101    true 
    1288    0.42998        57    0.096914     0.38862    true 
    1188    0.42548        66    0.033978     0.32198    true 
    1884    0.42038        70     0.19426     0.44204    true 
    1513    0.41744        96     0.10452     0.35239    true 
    2152    0.41646        89    0.070851      0.2151    true 
    1346    0.40791        40    0.078969     0.33416    true 
    1411    0.40789        86    0.048223     0.29447    true 
    2291    0.40734        56    0.069585     0.19216    true 
    1596    0.40493       111     0.14922     0.38594    true 
    2217    0.40262        81    0.035474     0.15823    true 
    1932    0.40163        58    0.053749     0.22379    true 
    2073    0.40068        32    0.049899     0.17592    true 
    2045    0.40053        89    0.023555     0.16031    true 
    2603    0.39868        56    0.046889     0.11105    true 
     574    0.39511        22    0.028861     0.36162    true 
    2409    0.39383    44.637    0.064983     0.15455    true 
    1255    0.39292        30    0.031753     0.26929    true 
    1807    0.38862        77    0.041937     0.22748    true 
    2686    0.38512    103.29    0.064342     0.10438    true 
     247    0.38496    67.594    0.063995     0.47461    true 
      95    0.37829        53    0.059176     0.43116    true 
    2334    0.37781        62    0.030883     0.12735    true 
    2562    0.37423        29    0.021422    0.052121    true 
     134    0.33348     60.88     0.11367     0.50486    true 
    1754    0.33153        32    0.023371     0.16483    true 
    1701    0.31814        74    0.075478     0.26996    true 
    2764    0.31644    31.359      0.1591     0.19671    true 
    2819    0.30628    41.262     0.27816     0.35877    true 
     185    0.21667    19.554    0.049967      0.3532    false
[sbestimatepeakloc] > minmax deltaHgts: [0.128717 0.430425], minmax deltaWids: [0.0127916 1.41161]
[sbestimatepeakloc] > minmax deltaLocs: [9.99115 2509.99], maxDeltaLoc: 26.5901
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=35.4535).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [319 35 16.3982] (hgt: 0.468519, HW: 35, L/R: [284 354])
[sbestimatepeakloc] > Max val in peak body: 0.475595
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.421667 0.495483], HW range: [1.275 38.5], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.537625 ; 3264 38.5 19.0761]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.537625 ; 3264 38.5 19.0761]
[curvefit] NumSampPoints: 71; class of XDATA: double, size of XDATA: [1 71]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.432049, maxY: 0.637722, min curve y: 0.205996, max curve y: 0.537734
min Y diff: -0.0746053, max Y diff: 0.295996, min wgts1: 0, max wgts1: 0
min Y delta: -0.00919827, max Y delta: 0.00532028, min curve y delta: -0.00984998, max curve y delta: 0.00984997
min Y delta diff: -0.0187984, max Y delta diff: 0.0110625, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Warning: Iteration limit exceeded.  Returning results from final iteration.
> In nlinfit (line 320)
In sbsense.improc.lzcurvefit (line 374)
In sbsense.improc.sbestimatepeakloc (line 293)
In sbsense.improc.analyzeCompositeParallel>analyzeCompositeChannel (line 254)
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 1.331, [310.771 35.9072 19.0761]
[sbestimatepeakloc] < p1WF: [672.877 1535.1 747.685]
[sbestimatepeakloc] < wres2QF1/2: [0.0178683 + 0.000186568 -> 0.0180549], [0.0244776 + 0.000170278 -> 0.0246479]
[sbestimatepeakloc] < wres2WF1/2: [0.00718258 + 0.109162 -> 0.116345], [0.000417614 + 0.000172533 -> 0.000590147]
[sbestimatepeakloc] <<< (wresnorm0WF 93.9916 > 0.5) && ((wresnorm0QF 0.0211083 <= 0.5) || (resnormQF 1.331 <= 0.5))
		==>WFisSuperior = false
[sbestimatepeakloc] <<< QF result is superior to WF --> resnorm=0.0211083, cfitBounds=[284 354], p1=[310.771 35.9072 19.0761]
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 0.0211083 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.0427598 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0796892
		==> Performing SF on peak body with guess "p0"=p1=[310.771 35.9072 19.0761] and fitParamBounds=[1 1.275 0.537625 ; 3264 38.5 19.0761].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[315.045 38.5 18.595] and resnorm_2=0.109413.
[sbestimatepeakloc] <<< resnorm (0.0211083) < resorm_2(0.109413) ==> @@@ Returning estimation [310.771 35.9072 19.0761] height: 0.531261, width: 71.8144
  Columns 1 through 8
    {[1]}    {[310.7709 … ]}    {[310.7709 0.5313]}    {[2 3264]}    {2×1 double}    {[284 354]}    {[0.0211]}    {9×71 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::5/2 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::5/2 Peak location estimation for Ch. 2 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (5) DIARY OF FUTURE 45 (chNum 3):
[analyzeCompositeChannel]::5/3 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::5/3 NaN count Y0c: 0/2206464, Y1c: 0/2206464, Ycc: 0/2206464
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[65.3285 187.013 85.2448], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 12 peaks (strictness: 2), of which 8 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score     Mask 
    ____    _______    ______    ________    _______    _____
      31    0.46295       149     0.11073    0.51519    true 
     181    0.42643        62    0.074934    0.42343    true 
     285    0.40378       114    0.087332    0.44273    true 
     234    0.39555        43    0.065199    0.39031    true 
     385    0.38732        60    0.059631    0.37493    true 
     502    0.36064       107     0.14541    0.44179    true 
     582    0.32447    58.967     0.10402     0.3644    true 
     437     0.2878        20    0.020747    0.28952    true 
     704    0.22328    61.848     0.14258    0.35035    false
     792    0.20038    111.67     0.10071      0.331    false
     673    0.19265    51.986    0.063597    0.28272    false
    2865    0.18842    88.727     0.77992       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.0156394 0.368618], minmax deltaWids: [0.601632 0.946528]
[sbestimatepeakloc] > minmax deltaLocs: [34.3285 516.671], maxDeltaLoc: 102
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=80).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [31 74.5 34.4899] (hgt: 0.462951, HW: 74.5, L/R: [1 106])
[sbestimatepeakloc] > Max val in peak body: 0.465545
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.416656 0.487395], HW range: [1.275 81.95], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.531236 ; 3264 81.95 39.9421]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.531236 ; 3264 81.95 39.9421]
[curvefit] NumSampPoints: 106; class of XDATA: double, size of XDATA: [1 106]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.456095, maxY: 0.457654, min curve y: 0.407595, max curve y: 0.455821
min Y diff: 0.001648, max Y diff: 0.0492753, min wgts1: 0, max wgts1: 0
min Y delta: -5.03297e-05, max Y delta: 3.55683e-05, min curve y delta: -0.000956781, max curve y delta: 0.0013347
min Y delta diff: -0.00129913, max Y delta diff: 0.000906451, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.263901, [53.4159 79.9194 39.9421]
[sbestimatepeakloc] < p1WF: [89.0971 278.409 132.656]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 39.9421/79.9194 = 0.499779 > maxPkHgt 0.488024.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=0.564253, cfitBounds=[1 3264], p1=[89.0971 278.409 132.656]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 0.564253 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [31 74.5 34.4899] (hgt: 0.462951, HW: 74.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[31 74.5 34.4899], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[65.3285 187.013 85.2448]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0694427 ; 3264 816 398.227]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0694427 ; 3264 816 398.227]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -1.07613, maxY: 0.286138, min curve y: 0.00155281, max curve y: 0.455821
min Y diff: -1.07768, max Y diff: 0.0121253, min wgts1: 0, max wgts1: 1
min Y delta: -0.000417489, max Y delta: 0, min curve y delta: -0.00158311, max curve y delta: 0.0013347
min Y delta diff: -0.00175219, max Y delta diff: 0.00116562, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0.05
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 1000.75 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] >>> resnorm 1000.75 >= 100e-4 ==> Reusing old guide (guide level: 3) [31 74.5 34.4899]
[sbestimatepeakloc] <<< Second fitting (weighted) succeeded with p1_2=[65.0456 187.433 85.4928] and resnorm_2=0.00120588.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.00120588) <= resnorm (1000.75) ==> Returning p1 = p1_2 ([65.0456 187.433 85.4928])
  Columns 1 through 8
    {[1]}    {[65.0456 … ]}    {[65.0456 0.4561]}    {[2 3264]}    {2×1 double}    {[45 179]}    {[0.0012]}    {11×135 double}
  Column 9
    {2×135 double}
[analyzeCompositeChannel]::5/3 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::5/3 Peak location estimation for Ch. 3 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[analyzeHCsP] (6) Internal (9 args)
[analyzeHCsP] (6) timePos:    31-Aug-2023 11:32:23
[analyzeHCsP] (6) Y0s class & size: uint16,         2038        3264
[analyzeHCsP] 6) Y1 class & size before crop: uint16,         2448        3264
[analyzeHCsP] (6) Num. IP points: 1631; Y1s class & size: uint16,         2038        3264
[analyzeCompositeP] (6) Size of Y0s: 2038       3264
[analyzeCompositeP] (6) Size of Y1s: 2038       3264
[analyzeCompositeP] (6) numChannels: 3
[analyzeCompositeP]::117 Class of Y0s,Y1s,Y0,Y1,Yr, ELI: int16,uint16,uint16,uint16,single, single
[analyzeCompositeP]::6/ch1 : Using supplied params "[107 37.5 14.3211]" as guess.
[analyzeCompositeP]::6/ch2 : Using supplied params "[310.771 35.9072 19.0761]" as guess.
[analyzeCompositeP]::6/ch3 : Using supplied params "[65.0456 187.433 85.4928]" as guess.
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (6) DIARY OF FUTURE 50 (chNum 1):
[analyzeCompositeChannel]::6/1 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::6/1 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[107 37.5 14.3211], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 7 peaks (strictness: 2), of which 6 meet(s) the general height and location requirements:
    Loc      Hgt       Wid        Prm        Score     Mask 
    ___    _______    ______    ________    _______    _____
    107    0.38323        76    0.093443    0.69404    true 
    193    0.34241    81.758    0.034984    0.38168    true 
     44    0.33748        28    0.026894    0.31595    true 
    157    0.33681        45    0.026189    0.34914    true 
    355    0.24621    38.299    0.087894    0.35059    true 
    318    0.24309        56     0.03081    0.20185    true 
    444    0.16215    25.792     0.17776       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.00350597 0.363472], minmax deltaWids: [0.0133333 0.626667]
[sbestimatepeakloc] > minmax deltaLocs: [0 248], maxDeltaLoc: 28.125
[sbestimatepeakloc] >> At least 1 effectively identical peak found (deltaLoc<=28.125 & deltaHgt<=0.05 & deltaWid<=0.10).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [107 38 14.5629] (hgt: 0.383234, HW: 38, L/R: [69 145])
[sbestimatepeakloc] > Max val in peak body: 0.422872
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.344911 -0.258952], HW range: [1.275 41.8], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.439761 ; 3264 41.8 -10.8242]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.439761 ; 3264 41.8 -10.8242]
[curvefit] NumSampPoints: 77; class of XDATA: double, size of XDATA: [1 77]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.355145, maxY: 0.403659, min curve y: 0.188419, max curve y: 0.381895
min Y diff: 0.0148683, max Y diff: 0.211845, min wgts1: 0, max wgts1: 0
min Y delta: -0.001601, max Y delta: 0.000413666, min curve y delta: -0.00661348, max curve y delta: 0.00661348
min Y delta diff: -0.00664212, max Y delta diff: 0.00545479, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 0.8968
Size of XDATA: [1 77]
Size of YDATA: [1 77]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.896753, [107 38 14.5629]
[sbestimatepeakloc] < p1WF: [110.204 45.488 20.527]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 14.5629/38 = 0.383234 > maxPkHgt -0.258952.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=14340, cfitBounds=[1 3264], p1=[110.204 45.488 20.527]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 14340 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [107 38 14.5629] (hgt: 0.383234, HW: 38)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[107 38 14.5629], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[107 37.5 14.3211]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0574851 ; 3264 816 -211.305]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0574851 ; 3264 816 -211.305]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -0.101849, maxY: 0.389446, min curve y: 5.38761e-05, max curve y: 0.381895
min Y diff: -0.101903, max Y diff: 0.346967, min wgts1: 0, max wgts1: 0
min Y delta: -0.000150565, max Y delta: 0, min curve y delta: -0.00661348, max curve y delta: 0.00661348
min Y delta diff: -0.00676405, max Y delta diff: 0.00646291, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 112.1194
Size of XDATA: [1 3264]
Size of YDATA: [1 3264]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 112.119 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.00969677 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0574851
		==> Performing SF on peak body with guess "p0"=p1=[107 38 14.5629] and fitParamBounds=[1 0.5 0.0574851 ; 3264 816 -211.305].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[107 38 14.5629] and resnorm_2=.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.213314) <= resnorm (112.119) ==> Returning p1 = p1_2 ([107 38 14.5629])
  Columns 1 through 8
    {[1]}    {[107 38 14.5629]}    {[107 0.3832]}    {[2 3264]}    {2×1 double}    {[84 130]}    {[0.2133]}    {9×3264 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::6/1 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::6/1 Peak location estimation for Ch. 1 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (6) DIARY OF FUTURE 52 (chNum 2):
[analyzeCompositeChannel]::6/2 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::6/2 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[310.771 35.9072 19.0761], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 41 peaks (strictness: 2), of which 40 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score     Mask 
    ____    _______    ______    ________    _______    _____
     319    0.46981        70     0.41715          1    true 
    2482     0.4674    107.15     0.37783    0.59299    true 
     381    0.46403        55    0.061782    0.48425    true 
     530    0.45813        62    0.066665    0.47257    true 
     442    0.45588        93    0.053266    0.45711    true 
     771    0.45314       150    0.087905    0.40792    true 
    1124     0.4457       110     0.03786     0.3163    true 
    1037     0.4445        65    0.020087     0.3302    true 
      38    0.43997        59    0.085555    0.48245    true 
     979     0.4395       171    0.030096    0.27501    true 
     807    0.43806        37    0.021731    0.34181    true 
    1288    0.43128        57    0.098013    0.38971    true 
     617      0.431        55    0.041617    0.41041    true 
    1188    0.42634        66    0.033662    0.32141    true 
    1884    0.42187        70     0.19661    0.44469    true 
    2152    0.41779        89    0.071062    0.21665    true 
    1513    0.41699        96      0.1026    0.35006    true 
    1346    0.40942        40    0.080106    0.33522    true 
    1411    0.40918        86    0.047581    0.29489    true 
    2290    0.40821        56    0.069025    0.19122    true 
    1596    0.40591       110     0.14713    0.38422    true 
    2217    0.40388        81    0.035307    0.15954    true 
    1932    0.40297        59    0.054582    0.22566    true 
    2045    0.40215        88    0.050178    0.19959    true 
    2073      0.402        32    0.023008    0.13822    true 
    2603    0.39993        56    0.047167    0.11139    true 
     574     0.3963        22     0.02823    0.36002    true 
    2409    0.39456    44.688    0.064417    0.15332    true 
    1255    0.39391        30    0.031417    0.26822    true 
    1809    0.39206        77     0.04383    0.23201    true 
     247    0.38621    67.611     0.06383    0.47361    true 
    2686    0.38618    103.43    0.063832    0.10462    true 
      95    0.37984        54    0.059898    0.43213    true 
    2334    0.37946        62    0.031397    0.12827    true 
    2562    0.37532        29    0.021077    0.05128    true 
     134    0.33526        61      0.1138    0.50417    true 
    1754    0.33361        33    0.023781    0.16609    true 
    1701    0.32021        74    0.077176    0.27391    true 
    2764    0.31796    32.187     0.15896    0.19632    true 
    2819    0.30758    41.408      0.2783    0.35767    true 
     185    0.21836    19.518    0.049107    0.35068    false
[sbestimatepeakloc] > minmax deltaHgts: [0.115672 0.421043], minmax deltaWids: [0.0252645 1.38114]
[sbestimatepeakloc] > minmax deltaLocs: [8.22913 2508.23], maxDeltaLoc: 26.9304
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=35.9072).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [319 35 16.4433] (hgt: 0.469809, HW: 35, L/R: [284 354])
[sbestimatepeakloc] > Max val in peak body: 0.476559
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.422828 0.496674], HW range: [1.275 38.5], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.539106 ; 3264 38.5 19.122]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.539106 ; 3264 38.5 19.122]
[curvefit] NumSampPoints: 71; class of XDATA: double, size of XDATA: [1 71]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.44534, maxY: 0.571042, min curve y: 0.216894, max curve y: 0.531239
min Y diff: -0.0680384, max Y diff: 0.267423, min wgts1: 0, max wgts1: 0
min Y delta: -0.00552923, max Y delta: 0.00305136, min curve y delta: -0.0096085, max curve y delta: 0.00960483
min Y delta diff: -0.014718, max Y delta diff: 0.0101936, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Warning: Iteration limit exceeded.  Returning results from final iteration.
> In nlinfit (line 320)
In sbsense.improc.lzcurvefit (line 374)
In sbsense.improc.sbestimatepeakloc (line 293)
In sbsense.improc.analyzeCompositeParallel>analyzeCompositeChannel (line 254)
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 1.03505, [314.076 36.4777 19.122]
[sbestimatepeakloc] < p1WF: [675.322 1537.26 751.219]
[sbestimatepeakloc] < wres2QF1/2: [0.0193564 + 0.000186169 -> 0.0195425], [0.0256282 + 0.000169802 -> 0.025798]
[sbestimatepeakloc] < wres2WF1/2: [0.00721347 + 0.108524 -> 0.115737], [0.000419941 + 0.000171947 -> 0.000591887]
[sbestimatepeakloc] <<< (wresnorm0WF 93.4956 > 0.5) && ((wresnorm0QF 0.022425 <= 0.5) || (resnormQF 1.03505 <= 0.5))
		==>WFisSuperior = false
[sbestimatepeakloc] <<< QF result is superior to WF --> resnorm=0.022425, cfitBounds=[284 354], p1=[314.076 36.4777 19.122]
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 0.022425 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.0282827 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0786315
		==> Performing SF on peak body with guess "p0"=p1=[314.076 36.4777 19.122] and fitParamBounds=[1 1.275 0.539106 ; 3264 38.5 19.122].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[317.327 38.5 18.866] and resnorm_2=0.0966404.
[sbestimatepeakloc] <<< resnorm (0.022425) < resorm_2(0.0966404) ==> @@@ Returning estimation [314.076 36.4777 19.122] height: 0.52421, width: 72.9553
  Columns 1 through 8
    {[1]}    {[314.0763 … ]}    {[314.0763 0.5242]}    {[2 3264]}    {2×1 double}    {[284 354]}    {[0.0224]}    {9×71 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::6/2 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::6/2 Peak location estimation for Ch. 2 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (6) DIARY OF FUTURE 54 (chNum 3):
[analyzeCompositeChannel]::6/3 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::6/3 NaN count Y0c: 0/2206464, Y1c: 0/2206464, Ycc: 0/2206464
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[65.0456 187.433 85.4928], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 12 peaks (strictness: 2), of which 8 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score     Mask 
    ____    _______    ______    ________    _______    _____
      31    0.46404       149     0.11153    0.51695    true 
     181    0.42735        62    0.074545    0.42384    true 
     285    0.40552       114    0.087241    0.44379    true 
     234    0.39665        43    0.065117    0.39071    true 
     385    0.38865        60    0.059412    0.37516    true 
     502    0.36221       107     0.14093    0.44054    true 
     582    0.32648     59.48     0.10396    0.36592    true 
     437    0.29029        20    0.021517     0.2898    true 
     704    0.22504    62.475     0.13937       0.35    false
     792     0.2013    115.14    0.095912       0.33    false
     673    0.19438    51.957    0.062578    0.28202    false
    2865    0.18992    89.521     0.76098       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.0173639 0.363573], minmax deltaWids: [0.602525 0.946648]
[sbestimatepeakloc] > minmax deltaLocs: [34.0456 516.954], maxDeltaLoc: 102
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=80).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [31 74.5 34.5713] (hgt: 0.464044, HW: 74.5, L/R: [1 106])
[sbestimatepeakloc] > Max val in peak body: 0.466801
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.417639 0.488624], HW range: [1.275 81.95], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.53249 ; 3264 81.95 40.0428]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.53249 ; 3264 81.95 40.0428]
[curvefit] NumSampPoints: 106; class of XDATA: double, size of XDATA: [1 106]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.45733, maxY: 0.459127, min curve y: 0.408436, max curve y: 0.456124
min Y diff: 0.0029215, max Y diff: 0.0488947, min wgts1: 0, max wgts1: 0
min Y delta: -6.61841e-05, max Y delta: 6.72564e-05, min curve y delta: -0.000959027, max curve y delta: 0.00132738
min Y delta diff: -0.00126012, max Y delta diff: 0.000892843, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.2638, [53.5053 79.8806 40.0428]
[sbestimatepeakloc] < p1WF: [89.7272 279.953 133.743]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 40.0428/79.8806 = 0.501283 > maxPkHgt 0.491709.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=0.563173, cfitBounds=[1 3264], p1=[89.7272 279.953 133.743]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 0.563173 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [31 74.5 34.5713] (hgt: 0.464044, HW: 74.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[31 74.5 34.5713], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[65.0456 187.433 85.4928]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0696065 ; 3264 816 401.235]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0696065 ; 3264 816 401.235]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -1.08193, maxY: 0.285179, min curve y: 0.00156053, max curve y: 0.456124
min Y diff: -1.08349, max Y diff: 0.0102475, min wgts1: 0, max wgts1: 1
min Y delta: -0.000418974, max Y delta: 0, min curve y delta: -0.00158061, max curve y delta: 0.00132738
min Y delta diff: -0.00174635, max Y delta diff: 0.00116163, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0.05
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 1013.31 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] >>> resnorm 1013.31 >= 100e-4 ==> Reusing old guide (guide level: 3) [31 74.5 34.5713]
[sbestimatepeakloc] <<< Second fitting (weighted) succeeded with p1_2=[61.221 196.262 89.6542] and resnorm_2=0.00121509.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.00121509) <= resnorm (1013.31) ==> Returning p1 = p1_2 ([61.221 196.262 89.6542])
  Columns 1 through 8
    {[1]}    {[61.2210 … ]}    {[61.2210 0.4568]}    {[2 3264]}    {2×1 double}    {[43 177]}    {[0.0012]}    {11×135 double}
  Column 9
    {2×135 double}
[analyzeCompositeChannel]::6/3 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::6/3 Peak location estimation for Ch. 3 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[analyzeHCsP] (7) Internal (9 args)
[analyzeHCsP] (7) timePos:    31-Aug-2023 11:32:24
[analyzeHCsP] (7) Y0s class & size: uint16,         2038        3264
[analyzeHCsP] 7) Y1 class & size before crop: uint16,         2448        3264
[analyzeHCsP] (7) Num. IP points: 1631; Y1s class & size: uint16,         2038        3264
[analyzeCompositeP] (7) Size of Y0s: 2038       3264
[analyzeCompositeP] (7) Size of Y1s: 2038       3264
[analyzeCompositeP] (7) numChannels: 3
[analyzeCompositeP]::117 Class of Y0s,Y1s,Y0,Y1,Yr, ELI: int16,uint16,uint16,uint16,single, single
[analyzeCompositeP]::7/ch1 : Using supplied params "[107 38 14.5629]" as guess.
[analyzeCompositeP]::7/ch2 : Using supplied params "[314.076 36.4777 19.122]" as guess.
[analyzeCompositeP]::7/ch3 : Using supplied params "[61.221 196.262 89.6542]" as guess.
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (7) DIARY OF FUTURE 59 (chNum 1):
[analyzeCompositeChannel]::7/1 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::7/1 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[107 38 14.5629], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 7 peaks (strictness: 2), of which 6 meet(s) the general height and location requirements:
    Loc      Hgt       Wid        Prm        Score     Mask 
    ___    _______    ______    ________    _______    _____
    107    0.38438        75    0.092146    0.68618    true 
    193    0.34283    81.815    0.033417    0.37423    true 
    157    0.33969        45    0.027194    0.34997    true 
     44    0.33889        29    0.026835     0.3143    true 
    355    0.24571    39.837    0.085937    0.34013    true 
    317    0.24102        55    0.031199    0.19712    true 
    443    0.16754     25.75     0.17893       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.00300225 0.371084], minmax deltaWids: [0.0131579 0.618421]
[sbestimatepeakloc] > minmax deltaLocs: [0 248], maxDeltaLoc: 28.5
[sbestimatepeakloc] >> At least 1 effectively identical peak found (deltaLoc<=28.5 & deltaHgt<=0.05 & deltaWid<=0.10).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [107 37.5 14.4144] (hgt: 0.384384, HW: 37.5, L/R: [69 145])
[sbestimatepeakloc] > Max val in peak body: 0.423569
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.345946 -0.25215], HW range: [1.275 41.25], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.441081 ; 3264 41.25 -10.4012]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.441081 ; 3264 41.25 -10.4012]
[curvefit] NumSampPoints: 77; class of XDATA: double, size of XDATA: [1 77]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.356386, maxY: 0.404459, min curve y: 0.191617, max curve y: 0.383234
min Y diff: 0.0124945, max Y diff: 0.211526, min wgts1: 0, max wgts1: 0
min Y delta: -0.00146315, max Y delta: 0.000232704, min curve y delta: -0.00654759, max curve y delta: 0.00654759
min Y delta diff: -0.00667913, max Y delta diff: 0.00544868, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 0.9241
Size of XDATA: [1 77]
Size of YDATA: [1 77]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.924092, [107 37.5 14.4144]
[sbestimatepeakloc] < p1WF: [110.651 45.884 20.7646]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 14.4144/37.5 = 0.384384 > maxPkHgt -0.25215.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=14199, cfitBounds=[1 3264], p1=[110.651 45.884 20.7646]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 14199 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [107 37.5 14.4144] (hgt: 0.384384, HW: 37.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[107 37.5 14.4144], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[107 38 14.5629]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0576577 ; 3264 816 -205.755]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0576577 ; 3264 816 -205.755]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -0.104397, maxY: 0.39068, min curve y: 5.55161e-05, max curve y: 0.383234
min Y diff: -0.104453, max Y diff: 0.347038, min wgts1: 0, max wgts1: 0
min Y delta: -0.000151725, max Y delta: 0, min curve y delta: -0.00654759, max curve y delta: 0.00654759
min Y delta diff: -0.00669931, max Y delta diff: 0.00639586, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 112.6235
Size of XDATA: [1 3264]
Size of YDATA: [1 3264]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 112.623 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.0109927 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0576577
		==> Performing SF on peak body with guess "p0"=p1=[107 37.5 14.4144] and fitParamBounds=[1 0.5 0.0576577 ; 3264 816 -205.755].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[107 37.5 14.4144] and resnorm_2=.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.214083) <= resnorm (112.623) ==> Returning p1 = p1_2 ([107 37.5 14.4144])
  Columns 1 through 8
    {[1]}    {[107 37.5000 … ]}    {[107 0.3844]}    {[2 3264]}    {2×1 double}    {[84 130]}    {[0.2141]}    {9×3264 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::7/1 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::7/1 Peak location estimation for Ch. 1 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (7) DIARY OF FUTURE 61 (chNum 2):
[analyzeCompositeChannel]::7/2 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::7/2 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[314.076 36.4777 19.122], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 41 peaks (strictness: 2), of which 40 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score      Mask 
    ____    _______    ______    ________    ________    _____
     319    0.47142        70     0.41362           1    true 
    2482      0.469    107.22     0.37686     0.59806    true 
     381    0.46568        55    0.061866     0.48499    true 
     531    0.45975        62    0.066608     0.47297    true 
     442    0.45722        93     0.05313     0.45922    true 
     771    0.45472       150    0.087748     0.41081    true 
    1124    0.44711       110    0.037451     0.31795    true 
    1038    0.44611        65    0.020075     0.33006    true 
      38    0.44132        59    0.083138     0.47886    true 
     979    0.44116       171    0.030128     0.27757    true 
     807    0.43971        37    0.021645     0.34189    true 
    1288    0.43308        57    0.097852     0.39057    true 
     617    0.43225        55    0.041401     0.41033    true 
    1188    0.42798        66    0.033144     0.32087    true 
    1884    0.42409        70     0.19364      0.4429    true 
    2152    0.41941        89    0.071143     0.21933    true 
    1513    0.41822        96     0.10234     0.35257    true 
    1346    0.41119        40    0.079581     0.33542    true 
    1411    0.41031        86    0.046049     0.29485    true 
    2290    0.40957        56     0.06835     0.19085    true 
    1596    0.40724       111     0.14655     0.38611    true 
    2217    0.40571        81    0.035474     0.16191    true 
    1932    0.40498        60    0.054591     0.22708    true 
    2045    0.40412        88    0.050685      0.2027    true 
    2073    0.40374        32    0.022431     0.13767    true 
    2603     0.4017        56    0.047132     0.11177    true 
     574    0.39792        22    0.028074     0.36014    true 
    1255    0.39567        30    0.031151     0.26822    true 
    2409    0.39566    44.766    0.063845     0.15307    true 
    1809    0.39293        76     0.04347     0.23423    true 
    2686    0.38811    103.65    0.063379     0.10644    true 
     248    0.38775     67.84    0.063526     0.47303    true 
    2334    0.38151        62    0.031719       0.129    true 
      95    0.38148        54    0.059629     0.43132    true 
    2562    0.37705        29    0.021015    0.051416    true 
     134    0.33617        61      0.1126     0.50243    true 
    1754    0.33569        33    0.022703     0.16491    true 
    1701    0.32368        73    0.078892     0.28023    true 
    2764    0.31691    32.182     0.15401     0.19038    true 
    2819    0.30864    41.558      0.2788     0.36158    true 
     185    0.22038    19.716    0.048443     0.34957    false
[sbestimatepeakloc] > minmax deltaHgts: [0.100705 0.411222], minmax deltaWids: [0.000612294 1.3439]
[sbestimatepeakloc] > minmax deltaLocs: [4.92374 2504.92], maxDeltaLoc: 27.3582
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=36.4777).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [319 35 16.4997] (hgt: 0.471419, HW: 35, L/R: [284 354])
[sbestimatepeakloc] > Max val in peak body: 0.47773
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.424277 0.498146], HW range: [1.275 38.5], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.540954 ; 3264 38.5 19.1786]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.540954 ; 3264 38.5 19.1786]
[curvefit] NumSampPoints: 71; class of XDATA: double, size of XDATA: [1 71]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.423351, maxY: 0.704156, min curve y: 0.238509, max curve y: 0.524208
min Y diff: -0.0806288, max Y diff: 0.392093, min wgts1: 0, max wgts1: 0
min Y delta: -0.012653, max Y delta: 0.00747271, min curve y delta: -0.00933072, max curve y delta: 0.00932892
min Y delta diff: -0.0211359, max Y delta diff: 0.0140813, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Warning: Iteration limit exceeded.  Returning results from final iteration.
> In nlinfit (line 320)
In sbsense.improc.lzcurvefit (line 374)
In sbsense.improc.sbestimatepeakloc (line 293)
In sbsense.improc.analyzeCompositeParallel>analyzeCompositeChannel (line 254)
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 1.64219, [307.539 34.9884 19.1786]
[sbestimatepeakloc] < p1WF: [673.678 1544.39 756.783]
[sbestimatepeakloc] < wres2QF1/2: [0.0158857 + 0.000187448 -> 0.0160731], [0.0225225 + 0.000171271 -> 0.0226938]
[sbestimatepeakloc] < wres2WF1/2: [0.00712463 + 0.107426 -> 0.114551], [0.000426828 + 0.000173604 -> 0.000600433]
[sbestimatepeakloc] <<< (wresnorm0WF 92.5344 > 0.5) && ((wresnorm0QF 0.0191415 <= 0.5) || (resnormQF 1.64219 <= 0.5))
		==>WFisSuperior = false
[sbestimatepeakloc] <<< QF result is superior to WF --> resnorm=0.0191415, cfitBounds=[284 354], p1=[307.539 34.9884 19.1786]
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 0.0191415 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.0657962 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0822213
		==> Performing SF on peak body with guess "p0"=p1=[307.539 34.9884 19.1786] and fitParamBounds=[1 1.275 0.540954 ; 3264 38.5 19.1786].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[315.033 38.5 18.5048] and resnorm_2=0.114535.
[sbestimatepeakloc] <<< resnorm (0.0191415) < resorm_2(0.114535) ==> @@@ Returning estimation [307.539 34.9884 19.1786] height: 0.548142, width: 69.9768
  Columns 1 through 8
    {[1]}    {[307.5393 … ]}    {[307.5393 0.5481]}    {[2 3264]}    {2×1 double}    {[284 354]}    {[0.0191]}    {9×71 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::7/2 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::7/2 Peak location estimation for Ch. 2 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (7) DIARY OF FUTURE 63 (chNum 3):
[analyzeCompositeChannel]::7/3 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::7/3 NaN count Y0c: 0/2206464, Y1c: 0/2206464, Ycc: 0/2206464
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[61.221 196.262 89.6542], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 12 peaks (strictness: 2), of which 8 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score     Mask 
    ____    _______    ______    ________    _______    _____
      31    0.46557       149     0.11096    0.51861    true 
     181     0.4288        61    0.074004    0.42334    true 
     284     0.4068       114    0.086984     0.4444    true 
     235    0.39641        44    0.062821    0.38896    true 
     385    0.39041        60    0.058472    0.37443    true 
     502     0.3637       107      0.1392    0.44104    true 
     582    0.32906    59.635     0.10221    0.36563    true 
     437    0.29252        20    0.021682    0.28848    true 
     704    0.22547    63.398     0.13545    0.34814    false
     792    0.20182    116.64    0.091935    0.32731    false
     673    0.19769    53.156    0.062558    0.28205    false
    2865    0.19464     91.07     0.73737       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.0191687 0.359651], minmax deltaWids: [0.620405 0.949048]
[sbestimatepeakloc] > minmax deltaLocs: [30.221 520.779], maxDeltaLoc: 102
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=80).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [31 74.5 34.6846] (hgt: 0.465566, HW: 74.5, L/R: [1 106])
[sbestimatepeakloc] > Max val in peak body: 0.468159
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.419009 0.490141], HW range: [1.275 81.95], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.534237 ; 3264 81.95 40.167]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.534237 ; 3264 81.95 40.167]
[curvefit] NumSampPoints: 106; class of XDATA: double, size of XDATA: [1 106]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.457015, maxY: 0.460821, min curve y: 0.417501, max curve y: 0.456809
min Y diff: 0.00401041, max Y diff: 0.0395138, min wgts1: 0, max wgts1: 0
min Y delta: -0.000100937, max Y delta: 0.000128476, min curve y delta: -0.000950961, max curve y delta: 0.00118658
min Y delta diff: -0.00105811, max Y delta diff: 0.000850024, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.260916, [53.6531 79.8949 40.167]
[sbestimatepeakloc] < p1WF: [89.796 281.844 135.031]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 40.167/79.8949 = 0.502748 > maxPkHgt 0.495593.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=0.557238, cfitBounds=[1 3264], p1=[89.796 281.844 135.031]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 0.557238 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [31 74.5 34.6846] (hgt: 0.465566, HW: 74.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[31 74.5 34.6846], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[61.221 196.262 89.6542]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0698348 ; 3264 816 404.404]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0698348 ; 3264 816 404.404]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -0.988391, maxY: 0.286923, min curve y: 0.00170893, max curve y: 0.456809
min Y diff: -0.9901, max Y diff: 0.0186895, min wgts1: 0, max wgts1: 1
min Y delta: -0.000390841, max Y delta: 0, min curve y delta: -0.00151178, max curve y delta: 0.00118658
min Y delta diff: -0.00157742, max Y delta diff: 0.00112094, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0.05
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 829.36 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] >>> resnorm 829.36 >= 100e-4 ==> Reusing old guide (guide level: 3) [31 74.5 34.6846]
[sbestimatepeakloc] <<< Second fitting (weighted) succeeded with p1_2=[62.994 208.603 95.4007] and resnorm_2=0.00128543.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.00128543) <= resnorm (829.36) ==> Returning p1 = p1_2 ([62.994 208.603 95.4007])
  Columns 1 through 8
    {[1]}    {[62.9940 … ]}    {[62.9940 0.4573]}    {[2 3264]}    {2×1 double}    {[45 194]}    {[0.0013]}    {11×150 double}
  Column 9
    {2×150 double}
[analyzeCompositeChannel]::7/3 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::7/3 Peak location estimation for Ch. 3 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[analyzeHCsP] (8) Internal (9 args)
[analyzeHCsP] (8) timePos:    31-Aug-2023 11:32:25
[analyzeHCsP] (8) Y0s class & size: uint16,         2038        3264
[analyzeHCsP] 8) Y1 class & size before crop: uint16,         2448        3264
[analyzeHCsP] (8) Num. IP points: 1631; Y1s class & size: uint16,         2038        3264
[analyzeCompositeP] (8) Size of Y0s: 2038       3264
[analyzeCompositeP] (8) Size of Y1s: 2038       3264
[analyzeCompositeP] (8) numChannels: 3
[analyzeCompositeP]::117 Class of Y0s,Y1s,Y0,Y1,Yr, ELI: int16,uint16,uint16,uint16,single, single
[analyzeCompositeP]::8/ch1 : Using supplied params "[107 37.5 14.4144]" as guess.
[analyzeCompositeP]::8/ch2 : Using supplied params "[307.539 34.9884 19.1786]" as guess.
[analyzeCompositeP]::8/ch3 : Using supplied params "[62.994 208.603 95.4007]" as guess.
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (8) DIARY OF FUTURE 68 (chNum 1):
[analyzeCompositeChannel]::8/1 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::8/1 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[107 37.5 14.4144], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 7 peaks (strictness: 2), of which 6 meet(s) the general height and location requirements:
    Loc      Hgt       Wid        Prm        Score     Mask 
    ___    _______    ______    ________    _______    _____
    107    0.38554        75    0.091768    0.68945    true 
    193    0.34374    81.553    0.033807    0.37933    true 
    157    0.34123        45    0.027065    0.35602    true 
     44    0.34002        28    0.026858    0.31944    true 
    317    0.24239        55    0.081108    0.38216    true 
    355    0.23842    39.282    0.025032    0.12257    true 
    443    0.17101    25.669     0.17832       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.00301733 0.379748], minmax deltaWids: [0 0.626667]
[sbestimatepeakloc] > minmax deltaLocs: [0 248], maxDeltaLoc: 28.125
[sbestimatepeakloc] >> At least 1 effectively identical peak found (deltaLoc<=28.125 & deltaHgt<=0.05 & deltaWid<=0.10).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [107 37.5 14.4579] (hgt: 0.385544, HW: 37.5, L/R: [69 145])
[sbestimatepeakloc] > Max val in peak body: 0.424516
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.34699 -0.247285], HW range: [1.275 41.25], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.442412 ; 3264 41.25 -10.2005]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.442412 ; 3264 41.25 -10.2005]
[curvefit] NumSampPoints: 77; class of XDATA: double, size of XDATA: [1 77]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.358987, maxY: 0.405719, min curve y: 0.189647, max curve y: 0.384384
min Y diff: 0.0147598, max Y diff: 0.212721, min wgts1: 0, max wgts1: 0
min Y delta: -0.00154607, max Y delta: 0.000404483, min curve y delta: -0.00665659, max curve y delta: 0.00665659
min Y delta diff: -0.00667979, max Y delta diff: 0.00553821, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 0.9403
Size of XDATA: [1 77]
Size of YDATA: [1 77]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.940296, [107 37.5 14.4579]
[sbestimatepeakloc] < p1WF: [110.778 46.0801 20.9158]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 14.4579/37.5 = 0.385544 > maxPkHgt -0.247285.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=14098.9, cfitBounds=[1 3264], p1=[110.778 46.0801 20.9158]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 14098.9 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [107 37.5 14.4579] (hgt: 0.385544, HW: 37.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[107 37.5 14.4579], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[107 37.5 14.4144]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0578316 ; 3264 816 -201.785]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0578316 ; 3264 816 -201.785]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -0.102635, maxY: 0.392515, min curve y: 5.42273e-05, max curve y: 0.384384
min Y diff: -0.10269, max Y diff: 0.349759, min wgts1: 0, max wgts1: 0
min Y delta: -0.000151747, max Y delta: 0, min curve y delta: -0.00665659, max curve y delta: 0.00665659
min Y delta diff: -0.00680834, max Y delta diff: 0.00650484, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 114.1494
Size of XDATA: [1 3264]
Size of YDATA: [1 3264]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 114.149 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.0110528 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0578316
		==> Performing SF on peak body with guess "p0"=p1=[107 37.5 14.4579] and fitParamBounds=[1 0.5 0.0578316 ; 3264 816 -201.785].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[107 37.5 14.4579] and resnorm_2=.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.213602) <= resnorm (114.149) ==> Returning p1 = p1_2 ([107 37.5 14.4579])
  Columns 1 through 8
    {[1]}    {[107 37.5000 … ]}    {[107 0.3855]}    {[2 3264]}    {2×1 double}    {[84 130]}    {[0.2136]}    {9×3264 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::8/1 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::8/1 Peak location estimation for Ch. 1 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (8) DIARY OF FUTURE 70 (chNum 2):
[analyzeCompositeChannel]::8/2 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::8/2 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[307.539 34.9884 19.1786], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 41 peaks (strictness: 2), of which 40 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score      Mask 
    ____    _______    ______    ________    ________    _____
     319     0.4725        70     0.41072           1    true 
    2482    0.46969    107.27     0.37663     0.59692    true 
     381    0.46673        55     0.06173     0.48563    true 
     531    0.46092        62    0.066221     0.47316    true 
     442    0.45819        93    0.052583     0.45446    true 
     771     0.4559       150    0.087699     0.40844    true 
    1124    0.44807       110     0.03718     0.31367    true 
    1038    0.44716        65    0.020041     0.33004    true 
      38    0.44252        59    0.074145      0.4691    true 
     979    0.44241       171    0.030411     0.27554    true 
     807    0.44077        37    0.021566     0.34252    true 
    1288    0.43443        57    0.096893     0.39027    true 
     617    0.43338        55     0.04164     0.41123    true 
    1188    0.42909        66    0.032816     0.32052    true 
    1884    0.42555        69     0.19249     0.44213    true 
    2151    0.42061        89    0.070498     0.21438    true 
    1512    0.41836        96     0.10068     0.34645    true 
    1346    0.41225        40    0.078216     0.33463    true 
    1411    0.41105        86    0.045016     0.28885    true 
    2290    0.41054        56    0.068054     0.19087    true 
    1596    0.40822       111     0.14864     0.38617    true 
    2217    0.40689        81    0.036032     0.15792    true 
    1932    0.40581        60    0.052715     0.22465    true 
    2045    0.40524        88    0.050964     0.19865    true 
    2073    0.40494        32     0.02256     0.13848    true 
    2603    0.40315        56    0.047308     0.11233    true 
     574    0.39925        22    0.028151     0.36147    true 
    1255    0.39694        30    0.031128     0.26911    true 
    2409    0.39674    44.791    0.063352     0.15305    true 
    1808    0.39154        78    0.041315     0.22418    true 
    2686    0.38951     103.8    0.063263     0.10216    true 
     247    0.38927     67.95    0.063788      0.4759    true 
      95    0.38294        54     0.05884     0.43299    true 
    2334    0.38275        62     0.03142     0.12854    true 
    2562    0.37821        29    0.020844    0.051728    true 
    1753    0.33791        32    0.022632     0.16507    true 
     134    0.33714        61     0.11212     0.50471    true 
    1701    0.32557        73    0.078076     0.27478    true 
    2764    0.31813    32.243     0.15276     0.19042    true 
    2819     0.3092    41.721     0.27685     0.36153    true 
     185    0.22223    19.926    0.048134      0.3527    false
[sbestimatepeakloc] > minmax deltaHgts: [0.137989 0.435913], minmax deltaWids: [0.000332098 1.44367]
[sbestimatepeakloc] > minmax deltaLocs: [11.4607 2511.46], maxDeltaLoc: 26.2413
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=34.9884).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [319 35 16.5377] (hgt: 0.472505, HW: 35, L/R: [284 354])
[sbestimatepeakloc] > Max val in peak body: 0.47899
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.425254 0.499373], HW range: [1.275 38.5], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.542199 ; 3264 38.5 19.2258]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.542199 ; 3264 38.5 19.2258]
[curvefit] NumSampPoints: 71; class of XDATA: double, size of XDATA: [1 71]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.41999, maxY: 0.730988, min curve y: 0.198366, max curve y: 0.548047
min Y diff: -0.0796705, max Y diff: 0.353642, min wgts1: 0, max wgts1: 0
min Y delta: -0.0140445, max Y delta: 0.00834471, min curve y delta: -0.010173, max curve y delta: 0.0101736
min Y delta diff: -0.0240823, max Y delta diff: 0.0138855, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Warning: Iteration limit exceeded.  Returning results from final iteration.
> In nlinfit (line 320)
In sbsense.improc.lzcurvefit (line 374)
In sbsense.improc.sbestimatepeakloc (line 293)
In sbsense.improc.analyzeCompositeParallel>analyzeCompositeChannel (line 254)
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 1.77076, [306.224 34.5142 19.2258]
[sbestimatepeakloc] < p1WF: [675.131 1547.08 760.045]
[sbestimatepeakloc] < wres2QF1/2: [0.0155751 + 0.000185047 -> 0.0157602], [0.0218268 + 0.000169199 -> 0.021996]
[sbestimatepeakloc] < wres2WF1/2: [0.0068941 + 0.106475 -> 0.113369], [0.000437116 + 0.000171556 -> 0.000608672]
[sbestimatepeakloc] <<< (wresnorm0WF 91.5829 > 0.5) && ((wresnorm0QF 0.0186486 <= 0.5) || (resnormQF 1.77076 <= 0.5))
		==>WFisSuperior = false
[sbestimatepeakloc] <<< QF result is superior to WF --> resnorm=0.0186486, cfitBounds=[284 354], p1=[306.224 34.5142 19.2258]
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 0.0186486 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.0786589 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0835561
		==> Performing SF on peak body with guess "p0"=p1=[306.224 34.5142 19.2258] and fitParamBounds=[1 1.275 0.542199 ; 3264 38.5 19.2258].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[314.254 38.5 18.4288] and resnorm_2=0.12048.
[sbestimatepeakloc] <<< resnorm (0.0186486) < resorm_2(0.12048) ==> @@@ Returning estimation [306.224 34.5142 19.2258] height: 0.557041, width: 69.0285
  Columns 1 through 8
    {[1]}    {[306.2236 … ]}    {[306.2236 0.5570]}    {[2 3264]}    {2×1 double}    {[284 354]}    {[0.0186]}    {9×71 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::8/2 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::8/2 Peak location estimation for Ch. 2 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (8) DIARY OF FUTURE 72 (chNum 3):
[analyzeCompositeChannel]::8/3 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::8/3 NaN count Y0c: 0/2206464, Y1c: 0/2206464, Ycc: 0/2206464
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[62.994 208.603 95.4007], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 12 peaks (strictness: 2), of which 8 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score     Mask 
    ____    _______    ______    ________    _______    _____
      31    0.46641       149     0.11023    0.51733    true 
     181    0.42963        62    0.073042    0.42365    true 
     284    0.40775       114    0.088255    0.44561    true 
     234    0.40002        43    0.063757    0.39064    true 
     385    0.39143        60     0.05854    0.37516    true 
     502     0.3648       107     0.14179    0.44255    true 
     582     0.3301    59.768     0.10211     0.3657    true 
     437     0.2937        20    0.021099    0.28926    true 
     704     0.2261    62.589     0.13509    0.34687    false
     792    0.20336    149.27    0.096434    0.34949    false
     673    0.20017     53.89    0.063469    0.28412    false
    2865    0.19507    90.951      0.7492       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.0198585 0.357797], minmax deltaWids: [0.642863 0.952062]
[sbestimatepeakloc] > minmax deltaLocs: [31.994 519.006], maxDeltaLoc: 102
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=80).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [31 74.5 34.7477] (hgt: 0.466413, HW: 74.5, L/R: [1 106])
[sbestimatepeakloc] > Max val in peak body: 0.468971
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.419771 0.491012], HW range: [1.275 81.95], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.535208 ; 3264 81.95 40.2385]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.535208 ; 3264 81.95 40.2385]
[curvefit] NumSampPoints: 106; class of XDATA: double, size of XDATA: [1 106]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.459104, maxY: 0.461871, min curve y: 0.420217, max curve y: 0.457331
min Y diff: 0.00447967, max Y diff: 0.0388865, min wgts1: 0, max wgts1: 0
min Y delta: -9.44606e-05, max Y delta: 0.000101078, min curve y delta: -0.000823623, max curve y delta: 0.00109413
min Y delta diff: -0.000993048, max Y delta diff: 0.000729162, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.264659, [53.536 79.8225 40.2385]
[sbestimatepeakloc] < p1WF: [90.1582 282.853 135.826]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 40.2385/79.8225 = 0.504099 > maxPkHgt 0.497876.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=0.558726, cfitBounds=[1 3264], p1=[90.1582 282.853 135.826]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 0.558726 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [31 74.5 34.7477] (hgt: 0.466413, HW: 74.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[31 74.5 34.7477], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[62.994 208.603 95.4007]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0699619 ; 3264 816 406.267]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0699619 ; 3264 816 406.267]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -0.985169, maxY: 0.288565, min curve y: 0.00193401, max curve y: 0.457331
min Y diff: -0.987103, max Y diff: 0.0104457, min wgts1: 0, max wgts1: 1
min Y delta: -0.000390357, max Y delta: 0, min curve y delta: -0.00142396, max curve y delta: 0.00109413
min Y delta diff: -0.00148448, max Y delta diff: 0.00103361, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0.05
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 822.42 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] >>> resnorm 822.42 >= 100e-4 ==> Reusing old guide (guide level: 3) [31 74.5 34.7477]
[sbestimatepeakloc] <<< Second fitting (weighted) succeeded with p1_2=[63.9806 201.377 92.3393] and resnorm_2=0.00134226.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.00134226) <= resnorm (822.42) ==> Returning p1 = p1_2 ([63.9806 201.377 92.3393])
  Columns 1 through 8
    {[1]}    {[63.9806 … ]}    {[63.9806 0.4585]}    {[2 3264]}    {2×1 double}    {[46 195]}    {[0.0013]}    {11×150 double}
  Column 9
    {2×150 double}
[analyzeCompositeChannel]::8/3 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::8/3 Peak location estimation for Ch. 3 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[analyzeHCsP] (9) Internal (9 args)
[analyzeHCsP] (9) timePos:    31-Aug-2023 11:32:26
[analyzeHCsP] (9) Y0s class & size: uint16,         2038        3264
[analyzeHCsP] 9) Y1 class & size before crop: uint16,         2448        3264
[analyzeHCsP] (9) Num. IP points: 1631; Y1s class & size: uint16,         2038        3264
[analyzeCompositeP] (9) Size of Y0s: 2038       3264
[analyzeCompositeP] (9) Size of Y1s: 2038       3264
[analyzeCompositeP] (9) numChannels: 3
[analyzeCompositeP]::117 Class of Y0s,Y1s,Y0,Y1,Yr, ELI: int16,uint16,uint16,uint16,single, single
[analyzeCompositeP]::9/ch1 : Using supplied params "[107 37.5 14.4579]" as guess.
[analyzeCompositeP]::9/ch2 : Using supplied params "[306.224 34.5142 19.2258]" as guess.
[analyzeCompositeP]::9/ch3 : Using supplied params "[63.9806 201.377 92.3393]" as guess.
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (9) DIARY OF FUTURE 77 (chNum 1):
[analyzeCompositeChannel]::9/1 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::9/1 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[107 37.5 14.4579], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 7 peaks (strictness: 2), of which 6 meet(s) the general height and location requirements:
    Loc      Hgt       Wid        Prm        Score     Mask 
    ___    _______    ______    ________    _______    _____
    107    0.38682        75    0.092911    0.69611    true 
    193    0.34435    81.839    0.034213    0.37692    true 
    157    0.34059        45    0.027154    0.35009    true 
     44     0.3405        28    0.026414    0.31075    true 
    318    0.24398        56    0.082534    0.39118    true 
    355    0.24108     37.92     0.02634      0.122    true 
    444    0.15858    28.105     0.17511       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.00329923 0.374712], minmax deltaWids: [0 0.626667]
[sbestimatepeakloc] > minmax deltaLocs: [0 248], maxDeltaLoc: 28.125
[sbestimatepeakloc] >> At least 1 effectively identical peak found (deltaLoc<=28.125 & deltaHgt<=0.05 & deltaWid<=0.10).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [107 37.5 14.5056] (hgt: 0.386816, HW: 37.5, L/R: [69 145])
[sbestimatepeakloc] > Max val in peak body: 0.425633
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.348135 -0.24579], HW range: [1.275 41.25], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.443872 ; 3264 41.25 -10.1389]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.443872 ; 3264 41.25 -10.1389]
[curvefit] NumSampPoints: 77; class of XDATA: double, size of XDATA: [1 77]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.35811, maxY: 0.406262, min curve y: 0.190219, max curve y: 0.385544
min Y diff: 0.0119218, max Y diff: 0.214773, min wgts1: 0, max wgts1: 0
min Y delta: -0.00146188, max Y delta: 0.000228143, min curve y delta: -0.00667668, max curve y delta: 0.00667668
min Y delta diff: -0.00681712, max Y delta diff: 0.00558338, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 0.9260
Size of XDATA: [1 77]
Size of YDATA: [1 77]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.925966, [107 37.5 14.5056]
[sbestimatepeakloc] < p1WF: [110.468 46.075 20.9475]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 14.5056/37.5 = 0.386816 > maxPkHgt -0.24579.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=14056.1, cfitBounds=[1 3264], p1=[110.468 46.075 20.9475]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 14056.1 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [107 37.5 14.5056] (hgt: 0.386816, HW: 37.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[107 37.5 14.5056], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[107 37.5 14.4579]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0580224 ; 3264 816 -200.565]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0580224 ; 3264 816 -200.565]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -0.107999, maxY: 0.39288, min curve y: 5.43909e-05, max curve y: 0.385544
min Y diff: -0.108054, max Y diff: 0.349994, min wgts1: 0, max wgts1: 0
min Y delta: -0.000153503, max Y delta: 0, min curve y delta: -0.00667668, max curve y delta: 0.00667668
min Y delta diff: -0.00683018, max Y delta diff: 0.00652317, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 113.3084
Size of XDATA: [1 3264]
Size of YDATA: [1 3264]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 113.308 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.0105835 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0580224
		==> Performing SF on peak body with guess "p0"=p1=[107 37.5 14.5056] and fitParamBounds=[1 0.5 0.0580224 ; 3264 816 -200.565].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[107 37.5 14.5056] and resnorm_2=.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.211206) <= resnorm (113.308) ==> Returning p1 = p1_2 ([107 37.5 14.5056])
  Columns 1 through 8
    {[1]}    {[107 37.5000 … ]}    {[107 0.3868]}    {[2 3264]}    {2×1 double}    {[84 130]}    {[0.2112]}    {9×3264 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::9/1 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::9/1 Peak location estimation for Ch. 1 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (9) DIARY OF FUTURE 79 (chNum 2):
[analyzeCompositeChannel]::9/2 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::9/2 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[306.224 34.5142 19.2258], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 41 peaks (strictness: 2), of which 40 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score      Mask 
    ____    _______    ______    ________    ________    _____
     319    0.47304        70     0.41224           1    true 
    2482    0.46985    107.28     0.37637     0.59333    true 
     382    0.46734        55    0.061411     0.48621    true 
     531    0.46132        62    0.065896     0.47367    true 
     442    0.45859        93    0.052182     0.45354    true 
     771    0.45653       150    0.087502     0.40775    true 
    1124    0.44853       110    0.037017     0.31285    true 
    1038     0.4476        65    0.020155     0.33109    true 
      38    0.44359        59    0.066947     0.46052    true 
     979    0.44282       171    0.030478      0.2754    true 
     807    0.44107        37     0.02134     0.34329    true 
    1288    0.43482        57    0.096644     0.39029    true 
     617    0.43377        55    0.041584     0.41221    true 
    1188    0.42943        66     0.03271     0.32106    true 
    1884    0.42655        69     0.19496     0.44525    true 
    2151    0.42105        89    0.069656     0.21172    true 
    1513    0.41932        96     0.10087     0.34551    true 
    1346    0.41273        40    0.078076     0.33494    true 
    1411    0.41186        86     0.04525     0.28837    true 
    2290    0.41103        56    0.068184     0.19099    true 
    1597    0.40837       111     0.14894      0.3849    true 
    2217    0.40738        81     0.03615     0.15671    true 
    1932    0.40598        59    0.051257     0.22192    true 
    2045    0.40548        88    0.050983     0.19728    true 
    2073    0.40544        33     0.02202     0.13891    true 
    2603    0.40379        56    0.046897     0.11165    true 
     574    0.40013        22    0.028242     0.36302    true 
    2409    0.39725    44.809    0.062824     0.15226    true 
    1255    0.39718        30    0.030882     0.26953    true 
    1807    0.39467        78    0.043824     0.22752    true 
    2686    0.39002    103.82    0.063318     0.10053    true 
     248    0.38947    67.875    0.063537     0.47698    true 
      95    0.38365        54    0.058411     0.43389    true 
    2334    0.38316        62     0.03112     0.12816    true 
    2562    0.37855        29    0.020512    0.051327    true 
     134    0.33858        61     0.11218     0.50623    true 
    1754    0.33762        31    0.022742     0.16458    true 
    1702    0.32592        74    0.077879     0.27216    true 
    2764    0.31801    32.356     0.15286     0.18973    true 
    2819    0.30881    42.036     0.27177     0.35295    true 
     185    0.22217    19.866    0.048118     0.35405    false
[sbestimatepeakloc] > minmax deltaHgts: [0.150799 0.445626], minmax deltaWids: [0.000412701 1.47724]
[sbestimatepeakloc] > minmax deltaLocs: [12.7764 2512.78], maxDeltaLoc: 25.8857
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=34.5142).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [319 35 16.5564] (hgt: 0.47304, HW: 35, L/R: [284 354])
[sbestimatepeakloc] > Max val in peak body: 0.479679
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.425736 0.500011], HW range: [1.275 38.5], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.542813 ; 3264 38.5 19.2504]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.542813 ; 3264 38.5 19.2504]
[curvefit] NumSampPoints: 71; class of XDATA: double, size of XDATA: [1 71]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.438587, maxY: 0.630473, min curve y: 0.191019, max curve y: 0.557017
min Y diff: -0.0792553, max Y diff: 0.312643, min wgts1: 0, max wgts1: 0
min Y delta: -0.00857745, max Y delta: 0.00495429, min curve y delta: -0.0104789, max curve y delta: 0.0104804
min Y delta diff: -0.0189989, max Y delta diff: 0.0106972, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Warning: Iteration limit exceeded.  Returning results from final iteration.
> In nlinfit (line 320)
In sbsense.improc.lzcurvefit (line 374)
In sbsense.improc.sbestimatepeakloc (line 293)
In sbsense.improc.analyzeCompositeParallel>analyzeCompositeChannel (line 254)
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 1.29933, [311.464 36.045 19.2504]
[sbestimatepeakloc] < p1WF: [673.68 1548.59 761.175]
[sbestimatepeakloc] < wres2QF1/2: [0.0185235 + 0.000186799 -> 0.0187103], [0.0249633 + 0.000170847 -> 0.0251342]
[sbestimatepeakloc] < wres2WF1/2: [0.00691359 + 0.106879 -> 0.113792], [0.000437195 + 0.000173111 -> 0.000610307]
[sbestimatepeakloc] <<< (wresnorm0WF 91.9265 > 0.5) && ((wresnorm0QF 0.0216922 <= 0.5) || (resnormQF 1.29933 <= 0.5))
		==>WFisSuperior = false
[sbestimatepeakloc] <<< QF result is superior to WF --> resnorm=0.0216922, cfitBounds=[284 354], p1=[311.464 36.045 19.2504]
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 0.0216922 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.0360984 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.08011
		==> Performing SF on peak body with guess "p0"=p1=[311.464 36.045 19.2504] and fitParamBounds=[1 1.275 0.542813 ; 3264 38.5 19.2504].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[314.738 38.5 18.8838] and resnorm_2=0.10171.
[sbestimatepeakloc] <<< resnorm (0.0216922) < resorm_2(0.10171) ==> @@@ Returning estimation [311.464 36.045 19.2504] height: 0.534067, width: 72.09
  Columns 1 through 8
    {[1]}    {[311.4642 … ]}    {[311.4642 0.5341]}    {[2 3264]}    {2×1 double}    {[284 354]}    {[0.0217]}    {9×71 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::9/2 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::9/2 Peak location estimation for Ch. 2 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (9) DIARY OF FUTURE 81 (chNum 3):
[analyzeCompositeChannel]::9/3 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::9/3 NaN count Y0c: 0/2206464, Y1c: 0/2206464, Ycc: 0/2206464
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[63.9806 201.377 92.3393], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 12 peaks (strictness: 2), of which 8 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score     Mask 
    ____    _______    ______    ________    _______    _____
      31    0.46675       149     0.11002    0.51726    true 
     181    0.43024        61    0.073147    0.42309    true 
     285    0.40792       114    0.089466    0.44624    true 
     234    0.40072        44     0.06351    0.39104    true 
     385    0.39179        60    0.058833    0.37529    true 
     502    0.36583       107     0.14247     0.4433    true 
     582    0.33139    60.201     0.10261    0.36667    true 
     437    0.29507        20    0.021121    0.28969    true 
     704    0.22672    62.241     0.13072    0.34379    false
     791    0.20741    149.41     0.10145    0.35487    false
     673    0.20237     54.41    0.063598    0.28539    false
    2865    0.19495    91.141     0.74815       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.0178982 0.35649], minmax deltaWids: [0.630047 0.950342]
[sbestimatepeakloc] > minmax deltaLocs: [32.9806 518.019], maxDeltaLoc: 102
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=80).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [31 74.5 34.7726] (hgt: 0.466746, HW: 74.5, L/R: [1 106])
[sbestimatepeakloc] > Max val in peak body: 0.46961
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.420071 0.491515], HW range: [1.275 81.95], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.535591 ; 3264 81.95 40.2797]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.535591 ; 3264 81.95 40.2797]
[curvefit] NumSampPoints: 106; class of XDATA: double, size of XDATA: [1 106]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.460265, maxY: 0.461976, min curve y: 0.417684, max curve y: 0.458539
min Y diff: 0.00336846, max Y diff: 0.0425803, min wgts1: 0, max wgts1: 0
min Y delta: -6.4265e-05, max Y delta: 6.4482e-05, min curve y delta: -0.000863918, max curve y delta: 0.0011757
min Y delta diff: -0.00111122, max Y delta diff: 0.000799653, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.267689, [53.5008 79.8518 40.2797]
[sbestimatepeakloc] < p1WF: [90.5683 283.447 136.26]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 40.2797/79.8518 = 0.50443 > maxPkHgt 0.499531.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=0.557149, cfitBounds=[1 3264], p1=[90.5683 283.447 136.26]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 0.557149 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [31 74.5 34.7726] (hgt: 0.466746, HW: 74.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[31 74.5 34.7726], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[63.9806 201.377 92.3393]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0700119 ; 3264 816 407.618]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0700119 ; 3264 816 407.618]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -1.00441, maxY: 0.289506, min curve y: 0.00180873, max curve y: 0.458539
min Y diff: -1.00622, max Y diff: 0.0133673, min wgts1: 1.11022e-16, max wgts1: 1
min Y delta: -0.000396541, max Y delta: 0, min curve y delta: -0.00147895, max curve y delta: 0.0011757
min Y delta diff: -0.00157224, max Y delta diff: 0.00108241, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 5.55112e-18, max wgts: 0.32 + 0.05
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 857.722 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] >>> resnorm 857.722 >= 100e-4 ==> Reusing old guide (guide level: 3) [31 74.5 34.7726]
[sbestimatepeakloc] <<< Second fitting (weighted) succeeded with p1_2=[61.7116 212.289 97.3491] and resnorm_2=0.00130924.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.00130924) <= resnorm (857.722) ==> Returning p1 = p1_2 ([61.7116 212.289 97.3491])
  Columns 1 through 8
    {[1]}    {[61.7116 … ]}    {[61.7116 0.4586]}    {[2 3264]}    {2×1 double}    {[45 193]}    {[0.0013]}    {11×149 double}
  Column 9
    {2×149 double}
[analyzeCompositeChannel]::9/3 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::9/3 Peak location estimation for Ch. 3 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[analyzeHCsP] (10) Internal (9 args)
[analyzeHCsP] (10) timePos:    31-Aug-2023 11:32:28
[analyzeHCsP] (10) Y0s class & size: uint16,         2038        3264
[analyzeHCsP] 10) Y1 class & size before crop: uint16,         2448        3264
[analyzeHCsP] (10) Num. IP points: 1631; Y1s class & size: uint16,         2038        3264
[analyzeCompositeP] (10) Size of Y0s: 2038       3264
[analyzeCompositeP] (10) Size of Y1s: 2038       3264
[analyzeCompositeP] (10) numChannels: 3
[analyzeCompositeP]::117 Class of Y0s,Y1s,Y0,Y1,Yr, ELI: int16,uint16,uint16,uint16,single, single
[analyzeCompositeP]::10/ch1 : Using supplied params "[107 37.5 14.5056]" as guess.
[analyzeCompositeP]::10/ch2 : Using supplied params "[311.464 36.045 19.2504]" as guess.
[analyzeCompositeP]::10/ch3 : Using supplied params "[61.7116 212.289 97.3491]" as guess.
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (10) DIARY OF FUTURE 88 (chNum 2):
[analyzeCompositeChannel]::10/2 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::10/2 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[311.464 36.045 19.2504], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 41 peaks (strictness: 2), of which 40 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score      Mask 
    ____    _______    ______    ________    ________    _____
     319    0.47177        70     0.41878           1    true 
    2482    0.46874    107.22     0.37667     0.58953    true 
     381    0.46625        55    0.060698     0.48217    true 
     531    0.45994        62    0.065852     0.47055    true 
     442    0.45756        93     0.05346     0.45714    true 
     770    0.45534       150    0.087085     0.40691    true 
    1123     0.4474       110    0.037073     0.31525    true 
    1038    0.44694        65    0.021018     0.33097    true 
      38    0.44327        59    0.076753     0.46976    true 
     979    0.44148       171    0.030247     0.27545    true 
     807    0.44007        37    0.021292     0.34082    true 
    1288    0.43313        57    0.097447     0.38809    true 
     617    0.43232        55    0.042154     0.41043    true 
    1188    0.42887        66    0.033159     0.32035    true 
    1885     0.4248        71     0.19477     0.44185    true 
    1513    0.42226        96      0.1056     0.35494    true 
    2151    0.41969        89    0.069437      0.2143    true 
    1411    0.41182        86    0.076641     0.33514    true 
    1346    0.41159        40    0.046792     0.28867    true 
    2291    0.40998        56    0.068505     0.18962    true 
    1597    0.40706       110     0.14089     0.37477    true 
    2217    0.40612        81    0.035298     0.15953    true 
    1932    0.40519        58    0.052382     0.22129    true 
    2073    0.40377        33    0.050682     0.17683    true 
    2045    0.40359        88    0.022144      0.1606    true 
    2603    0.40237        56    0.046772     0.11042    true 
     574    0.39969        22    0.027646      0.3594    true 
    1255     0.3961        30    0.030243     0.26633    true 
    2409    0.39597    44.776    0.062735     0.15031    true 
    1807    0.39318        77    0.041912      0.2293    true 
    2686    0.38904    103.63    0.064323     0.10531    true 
     248    0.38806    67.731    0.063055     0.47199    true 
      95    0.38197        54      0.0579     0.42873    true 
    2334    0.38161        62    0.031194     0.12758    true 
    2562    0.37729        29     0.02049    0.050162    true 
     134    0.33653        61     0.11057     0.49865    true 
    1754    0.33618        31    0.021809     0.16171    true 
    1702    0.32289        75    0.073827     0.26847    true 
    2764    0.31623      32.3     0.15414      0.1878    true 
    2819    0.30741    41.812     0.27278     0.34839    true 
     185    0.21849    19.477    0.045849     0.34541    false
[sbestimatepeakloc] > minmax deltaHgts: [0.116651 0.424389], minmax deltaWids: [0.0151199 1.37204]
[sbestimatepeakloc] > minmax deltaLocs: [7.53577 2507.54], maxDeltaLoc: 27.0337
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=36.045).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [319 35 16.5119] (hgt: 0.471767, HW: 35, L/R: [284 354])
[sbestimatepeakloc] > Max val in peak body: 0.478482
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.42459 0.498713], HW range: [1.275 38.5], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.541353 ; 3264 38.5 19.2005]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.541353 ; 3264 38.5 19.2005]
[curvefit] NumSampPoints: 71; class of XDATA: double, size of XDATA: [1 71]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.43178, maxY: 0.659692, min curve y: 0.223218, max curve y: 0.533978
min Y diff: -0.0773356, max Y diff: 0.321794, min wgts1: 0, max wgts1: 0
min Y delta: -0.0102455, max Y delta: 0.00601193, min curve y delta: -0.00962151, max curve y delta: 0.00962195
min Y delta diff: -0.0193585, max Y delta diff: 0.0122168, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Warning: Iteration limit exceeded.  Returning results from final iteration.
> In nlinfit (line 320)
In sbsense.improc.lzcurvefit (line 374)
In sbsense.improc.sbestimatepeakloc (line 293)
In sbsense.improc.analyzeCompositeParallel>analyzeCompositeChannel (line 254)
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 1.43715, [309.929 35.7058 19.2005]
[sbestimatepeakloc] < p1WF: [674.504 1543.4 757.104]
[sbestimatepeakloc] < wres2QF1/2: [0.0173086 + 0.000185556 -> 0.0174942], [0.0240238 + 0.000169853 -> 0.0241937]
[sbestimatepeakloc] < wres2WF1/2: [0.00696067 + 0.107253 -> 0.114214], [0.000430399 + 0.000172152 -> 0.000602551]
[sbestimatepeakloc] <<< (wresnorm0WF 92.2643 > 0.5) && ((wresnorm0QF 0.0206069 <= 0.5) || (resnormQF 1.43715 <= 0.5))
		==>WFisSuperior = false
[sbestimatepeakloc] <<< QF result is superior to WF --> resnorm=0.0206069, cfitBounds=[284 354], p1=[309.929 35.7058 19.2005]
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 0.0206069 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.0474387 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0806611
		==> Performing SF on peak body with guess "p0"=p1=[309.929 35.7058 19.2005] and fitParamBounds=[1 1.275 0.541353 ; 3264 38.5 19.2005].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[314.675 38.5 18.6658] and resnorm_2=0.10619.
[sbestimatepeakloc] <<< resnorm (0.0206069) < resorm_2(0.10619) ==> @@@ Returning estimation [309.929 35.7058 19.2005] height: 0.537741, width: 71.4116
  Columns 1 through 8
    {[1]}    {[309.9288 … ]}    {[309.9288 0.5377]}    {[2 3264]}    {2×1 double}    {[284 354]}    {[0.0206]}    {9×71 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::10/2 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::10/2 Peak location estimation for Ch. 2 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (10) DIARY OF FUTURE 86 (chNum 1):
[analyzeCompositeChannel]::10/1 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::10/1 NaN count Y0c: 0/2219520, Y1c: 0/2219520, Ycc: 0/2219520
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[107 37.5 14.5056], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 7 peaks (strictness: 2), of which 6 meet(s) the general height and location requirements:
    Loc      Hgt       Wid        Prm        Score     Mask 
    ___    _______    ______    ________    _______    _____
    107    0.38544        76    0.092667    0.70012    true 
    192    0.34242    81.471    0.033325    0.37665    true 
     44     0.3403        29     0.02781    0.31758    true 
    157    0.33749        43    0.026089    0.34314    true 
    317    0.24122        55    0.083256    0.39704    true 
    355    0.23797    39.114     0.02774    0.12844    true 
    443    0.15801     28.27     0.17249       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.00356175 0.384808], minmax deltaWids: [0.0133333 0.613333]
[sbestimatepeakloc] > minmax deltaLocs: [0 248], maxDeltaLoc: 28.125
[sbestimatepeakloc] >> At least 1 effectively identical peak found (deltaLoc<=28.125 & deltaHgt<=0.05 & deltaWid<=0.10).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [107 38 14.6467] (hgt: 0.385439, HW: 38, L/R: [69 145])
[sbestimatepeakloc] > Max val in peak body: 0.42365
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.346895 -0.250279], HW range: [1.275 41.8], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.442291 ; 3264 41.8 -10.4617]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.442291 ; 3264 41.8 -10.4617]
[curvefit] NumSampPoints: 77; class of XDATA: double, size of XDATA: [1 77]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.357251, maxY: 0.405243, min curve y: 0.190847, max curve y: 0.386816
min Y diff: 0.0120897, max Y diff: 0.210316, min wgts1: 0, max wgts1: 0
min Y delta: -0.00161741, max Y delta: 0.000461837, min curve y delta: -0.0066987, max curve y delta: 0.0066987
min Y delta diff: -0.00669363, max Y delta diff: 0.00553806, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 0.9002
Size of XDATA: [1 77]
Size of YDATA: [1 77]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.900186, [107 38 14.6467]
[sbestimatepeakloc] < p1WF: [109.338 46.6162 20.8963]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 14.6467/38 = 0.385439 > maxPkHgt -0.250279.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=14147.4, cfitBounds=[1 3264], p1=[109.338 46.6162 20.8963]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 14147.4 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [107 38 14.6467] (hgt: 0.385439, HW: 38)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[107 38 14.6467], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[107 37.5 14.5056]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0578158 ; 3264 816 -204.228]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0578158 ; 3264 816 -204.228]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -0.111565, maxY: 0.390415, min curve y: 5.45704e-05, max curve y: 0.386816
min Y diff: -0.11162, max Y diff: 0.347388, min wgts1: 0, max wgts1: 0
min Y delta: -0.00015384, max Y delta: 0, min curve y delta: -0.0066987, max curve y delta: 0.0066987
min Y delta diff: -0.00685254, max Y delta diff: 0.00654486, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
Somehow resnorm was empty even though p1 was not. Now resnorm (recalculated) is: 110.8551
Size of XDATA: [1 3264]
Size of YDATA: [1 3264]
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 110.855 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] > 0.00941283 = |mean(Y0body - predbody)| <= 0.15*p1Hgt = 0.0578158
		==> Performing SF on peak body with guess "p0"=p1=[107 38 14.6467] and fitParamBounds=[1 0.5 0.0578158 ; 3264 816 -204.228].
[sbestimatepeakloc] <<< Second fitting (slow, peak body only) succeeded with p1_2=[107 38 14.6467] and resnorm_2=.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.211461) <= resnorm (110.855) ==> Returning p1 = p1_2 ([107 38 14.6467])
  Columns 1 through 8
    {[1]}    {[107 38 14.6467]}    {[107 0.3854]}    {[2 3264]}    {2×1 double}    {[84 130]}    {[0.2115]}    {9×3264 double}
  Column 9
    {0×0 double}
[analyzeCompositeChannel]::10/1 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::10/1 Peak location estimation for Ch. 1 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
[analyzeCompositeP/printDiaryToFile] (10) DIARY OF FUTURE 90 (chNum 3):
[analyzeCompositeChannel]::10/3 PSB class: single, PSZ class: single
[analyzeCompositeChannel]::10/3 NaN count Y0c: 0/2206464, Y1c: 0/2206464, Ycc: 0/2206464
[sbestimatepeakloc] peakSearchBounds: [2 3264]; peakSearchZone: [1 3264];peakSearchZone0: [1 3264]
[sbestimatepeakloc] ~~~~~~ PART I (GUIDE PEAK OBTAINMENT) ~~~~~~
[sbestimatepeakloc] >>> Calling getProfileContourInfo with arguments (size):
		XDATA ([1 3264]), YDATA0 ([1 3264]), p01=[61.7116 212.289 97.3491], AND peakSearchZone=[1 3264]
[sbestimatepeakloc] >> Found 12 peaks (strictness: 2), of which 8 meet(s) the general height and location requirements:
    Loc       Hgt       Wid        Prm        Score     Mask 
    ____    _______    ______    ________    _______    _____
      31    0.46574       149     0.10966    0.51664    true 
     181    0.42943        61    0.074125     0.4227    true 
     285    0.40601       114    0.089408    0.44459    true 
     235    0.39702        44    0.061204    0.38729    true 
     385    0.39099        60    0.059237    0.37451    true 
     502    0.36536       107     0.14183    0.44175    true 
     582    0.33096    60.489     0.10275    0.36606    true 
     437    0.29454        20    0.021671    0.28927    true 
     704    0.22417    62.191     0.12656     0.3392    false
     792    0.20751    150.31     0.10293    0.35541    false
     673    0.20212    54.413    0.064606    0.28539    false
    2865    0.19546    91.089     0.74791       0.55    false
[sbestimatepeakloc] > minmax deltaHgts: [0.015632 0.357697], minmax deltaWids: [0.649064 0.952894]
[sbestimatepeakloc] > minmax deltaLocs: [30.7116 520.288], maxDeltaLoc: 102
[sbestimatepeakloc] >> At least 1 nearby peak found (deltaLoc<=80).
[sbestimatepeakloc] >> 1 nearby peaks were found, of which 1 meet(s) the precedent-based height requirements.
[sbestimatepeakloc] >>> The only nearby peak (peak 1) was chosen.
[sbestimatepeakloc] > p0g: [31 74.5 34.6974] (hgt: 0.465737, HW: 74.5, L/R: [1 106])
[sbestimatepeakloc] > Max val in peak body: 0.468778
[sbestimatepeakloc] > YDATA1 length: 3264
[sbestimatepeakloc] > Hgt range: [0.419163 0.490544], HW range: [1.275 81.95], Loc range: [1 3264]=PSZ
[sbestimatepeakloc] ~~~~~~ PART II (PRIMARY/PRELIMINARY FITTING) ~~~~~~
[lzcurvefit] nargout: 7, nargin: 11
[curvefit] fitParamBounds: [1 1.275 0.534433 ; 3264 81.95 40.2001]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 1.275 0.534433 ; 3264 81.95 40.2001]
[curvefit] NumSampPoints: 106; class of XDATA: double, size of XDATA: [1 106]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: 0.456991, maxY: 0.461333, min curve y: 0.423899, max curve y: 0.458568
min Y diff: 0.00275298, max Y diff: 0.0330917, min wgts1: 0, max wgts1: 0
min Y delta: -0.000120343, max Y delta: 0.00014855, min curve y delta: -0.000819866, max curve y delta: 0.00104966
min Y delta diff: -0.00090111, max Y delta diff: 0.000699523, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 0, max wgts: 0.32 + 0
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] < resnormQF, p1QF: 0.259644, [53.6572 79.8924 40.2001]
[sbestimatepeakloc] < p1WF: [89.8795 282.5 135.397]
[sbestimatepeakloc] <<< WF is superior, since p1QF A/B = 40.2001/79.8924 = 0.503178 > maxPkHgt 0.496973.
[sbestimatepeakloc] <<< WF result is superior to QF --> resnorm=0.559908, cfitBounds=[1 3264], p1=[89.8795 282.5 135.397]
[sbestimatepeakloc] ~~~~~~ PART IIb (REPARATORY/UNGUIDED FITTING) ~~~~~~
[sbestimatepeakloc] >>> Performing an additional, unguided fitting since the preliminary guided fitting was unsatisfactory/unsuccessful (resnorm 0.559908 >= 0.5).
[sbestimatepeakloc] > XDATA class, size, min, max, # NaN: double, [1 3264], 1, 3264, 0
[sbestimatepeakloc] maxHW: 3264, double(diff(XDATA([1 end])) + 1): 3264
[sbestimatepeakloc] > p0g: [31 74.5 34.6974] (hgt: 0.465737, HW: 74.5)
[sbestimatepeakloc] >>> CALLING lzcurvefit with arguments "p0"=p0=[31 74.5 34.6974], XDATA, YDATA0, peakSearchBounds=[2 3264], peakSearchZone=[1 3264],
		xmax, FBPM=[], preferFBM=false, fitParamBounds=[pSZ(1) eps eps ; pSZ(2) inf inf], 1, "p001"=p01=[61.7116 212.289 97.3491]
[lzcurvefit] nargout: 4, nargin: 11
[curvefit] fitParamBounds: [1 0.5 0.0698605 ; 3264 816 405.53]
[curvefit] PSB: [2 3264] --> fitParamBounds: [2 0.5 0.0698605 ; 3264 816 405.53]
[curvefit] NumSampPoints: 2; class of XDATA: double, size of XDATA: [1 2]
[curvefit] smoothingLevel > -1 --> filling outliers
[curvefit] smoothingLevel > 0 --> smoothing data
[curvefit] #fitpoints ~= numSampPoints --> interp1
[curvefit] (pre-interp1) # ydata NaN / # ydata = 0/2
[curvefit] (post-interp1) Size of xdata,ydata: [1 3264],[1 3264]
[curvefit] (post-interp1) # ydata NaN / # ydata = 0/3264
[curvefit] doPass2: 0; class(XDATA),class(YDATA)): double, double
minY: -1.05621, maxY: 0.290983, min curve y: 0.00200648, max curve y: 0.458568
min Y diff: -1.05822, max Y diff: 8.25642e-05, min wgts1: 1.11022e-16, max wgts1: 1
min Y delta: -0.000412869, max Y delta: 0, min curve y delta: -0.00140303, max curve y delta: 0.00104966
min Y delta diff: -0.00146253, max Y delta diff: 0.000990156, min wgts2: 0, max wgts2: 0
min wgts: 0.35 + 5.55112e-18, max wgts: 0.32 + 0.05
[curvefit] doPass2 is false, so returning without doing second pass.
[sbestimatepeakloc] <<< *** Unguided fitting was SUCCESSFUL ***
[sbestimatepeakloc] <<< *** Fitting was SUCCESSFUL but resnorm 957.272 > 5e-4, so attempting a second-pass fitting for refinement. ***
[sbestimatepeakloc] ~~~~~~ PART III (SECONDARY/FOLLOW-UP FITTING) ~~~~~~
[sbestimatepeakloc] >>> resnorm 957.272 >= 100e-4 ==> Reusing old guide (guide level: 3) [31 74.5 34.6974]
[sbestimatepeakloc] <<< Second fitting (weighted) succeeded with p1_2=[68.0219 175.164 80.567] and resnorm_2=0.00128511.
[sbestimatepeakloc] <<< @@@ resnorm_2 (0.00128511) <= resnorm (957.272) ==> Returning p1 = p1_2 ([68.0219 175.164 80.567])
  Columns 1 through 8
    {[1]}    {[68.0219 … ]}    {[68.0219 0.4600]}    {[2 3264]}    {2×1 double}    {[46 186]}    {[0.0013]}    {11×141 double}
  Column 9
    {2×141 double}
[analyzeCompositeChannel]::10/3 NaN count XDATA: 0/3264, channelIP: 0/3264
[analyzeCompositeChannel]::10/3 Peak location estimation for Ch. 3 was successful.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[analyzeHCsP] (1) Reanalyzing datapoint #1.[analyzeHCsP] (1) Y0s class & size: uint16,         2038        3264
[analyzeHCsP] 1) Y1 class & size before crop: uint16,         2448        3264
[analyzeHCsP] (1) Num. IP points: 1631; Y1s class & size: uint16,         2038        3264
[analyzeCompositeP] (1) Size of Y0s: 2038       3264
[analyzeCompositeP] (1) Size of Y1s: 2038       3264
[analyzeCompositeP] (1) numChannels: 3
[analyzeCompositeP]::117 Class of Y0s,Y1s,Y0,Y1,Yr, ELI: int16,uint16,uint16,uint16,single, single
[analyzeHCsP] (1) Error occurred during analysis: Index in position 2 exceeds array bounds. Index must not exceed 1.
Error in sbsense.improc.analyzeCompositeParallel (line 141)
        peakSearchZones(:,chNum), ...
Error in sbsense.improc.analyzeHCsParallel (line 103)
        sbsense.improc.analyzeCompositeParallel(  ... % analyzerObj, ...
Error in onReanalyzeButtonPushed (line 140)
                    data = sbsense.improc.analyzeHCsParallel(app.Analyzer, app.AnalysisParams, ...
Error in createComponents>@(varargin)app.onReanalyzeButtonPushed(varargin{:}) (line 1442)
app.ReanalyzeButton.ButtonPushedFcn = @app.onReanalyzeButtonPushed;
[analyzeHCsP] (1) Reanalyzing datapoint #1.[analyzeHCsP] (1) Y0s class & size: uint16,         2038        3264
[analyzeHCsP] 1) Y1 class & size before crop: uint16,         2448        3264
[analyzeHCsP] (1) Num. IP points: 1631; Y1s class & size: uint16,         2038        3264
[analyzeCompositeP] (1) Size of Y0s: 2038       3264
[analyzeCompositeP] (1) Size of Y1s: 2038       3264
[analyzeCompositeP] (1) numChannels: 3
[analyzeCompositeP]::117 Class of Y0s,Y1s,Y0,Y1,Yr, ELI: int16,uint16,uint16,uint16,single, single
[analyzeCompositeP]::ch1 : Effective PSZ: 0     0.
[analyzeHCsP] (1) Error occurred during analysis: Index in position 2 exceeds array bounds. Index must not exceed 1.
Error in sbsense.improc.analyzeCompositeParallel (line 133)
            chNum, strip(formattedDisplayText(peakSearchZones(:,chNum)')));
Error in sbsense.improc.analyzeHCsParallel (line 103)
        sbsense.improc.analyzeCompositeParallel(  ... % analyzerObj, ...
Error in onReanalyzeButtonPushed (line 140)
                    data = sbsense.improc.analyzeHCsParallel(app.Analyzer, app.AnalysisParams, ...
Error in createComponents>@(varargin)app.onReanalyzeButtonPushed(varargin{:}) (line 1442)
app.ReanalyzeButton.ButtonPushedFcn = @app.onReanalyzeButtonPushed;
